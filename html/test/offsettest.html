<html>
<body>
<script src="../vendor/soundmanager2-nodebug-97a-20131201.js" type="application/javascript"></script>
<script>

/*

To start playback at a particular offset, I've got to:
  - 'load' the play, rather than 'play' it on creation 
  - while the play is loading, look at the 'duration' of the song.
    when the 'duration' is >= our start offset, then we can start
    playing the song.
*/

function createSong() {
  // create a song, and start playback halfway into it
  var sound = soundManager.createSound({
    id: 'hutz',
    url: 'https://d1jys12wsigh0s.cloudfront.net/files/6/28/EWYse6.mp3',
    autoplay: false,
    type: 'audio/mp3',
    onload: function(success) {
      console.log(sound.id + ': onload', success);
      if (!success) {
        console.log(sound.id + ' failure!');
      }
    },
    onfinish: function() {
      console.log('finished!');
    }
  });

  console.log('created', sound);

  sound.load({
    whileloading: function() {
      console.log('duration while loading: ', this.duration);
      if ((this.duration > 185000) && (this.playState === 0)) {
        // start playback as soon as we can
        console.log('setting position');
        this.setPosition(185000);
        console.log('playing');
        this.play();
      }
    }
  });
}


var config = {
  wmode: 'transparent',
  useHighPerformance: true,
  flashPollingInterval: 500,
  html5PollingInterval: 500,
  debugMode: true, 
  debugFlash: true,
  preferFlash: false,
  url: 'http://feed.fm/js/latest',
  onready:  createSong
};

soundManager.setup(config);

</script>

</body>
</html>
