<!DOCTYPE html>
<html>
<head>
  <title>Mocha Spec Runner</title>
  <link rel="stylesheet" type="text/css" href="css/mocha.css">
</head>
<body>
  <div id="mocha"></div>

  <script src="../vendor/jquery-1.10.2.js" type="text/javascript"></script>
  <script src="../vendor/mocha.js" type="text/javascript"></script>
  <script src="../vendor/chai.js" type="text/javascript"></script>
  <script src="../vendor/sinon.js" type="text/javascript"></script>

  <script>
    mocha.setup('bdd');
    mocha.globals([ 
      'navigator',
      'top',
      '__flash_temp',
      '__flash__arrayToXML', 
      '__flash__argumentsToXML', 
      '__flash__objectToXML', 
      '__flash__escapeXML', 
      '__flash__toXML', 
      '__flash__request', 
      '__flash__addCallback', 
      '__flash__removeCallback',
      '__flash_getTopLocation',
      '__flash_getWindowLocation',
      'jQuery*'
    ]);

  </script>

  <!-- tests -->
  <script src="../test/mocha.js" type="text/javascript"></script>
  <script src="../test/session.js" type="text/javascript"></script>
  <script src="../test/session-auth.js" type="text/javascript"></script>
  <script src="../test/speaker.js" type="text/javascript"></script>
  <script src="../test/player.js" type="text/javascript"></script>

  <!-- code-->
  <script src="../src/config.js" type="application/javascript"></script>
  <script src="../vendor/require.js" type="application/javascript"></script>

  <script>
    require([ 'jquery', 'feed/feed' ], function($, Feed) {
      window.Feed = Feed;

      if (window.userAgent =~ /iPod|iPhone|iPad/) {
        var $el = $('<button>Click me to start test</button>');

        $el.appendTo($('body'));
        $el.on('click', function() {
        /*
          var speaker = Feed.getSpeaker({}) 
          speaker.initializeForMobile();
          */

          mocha.run();
        });

      } else {
        mocha.run();
      }
    });
  </script>
</body>
</html>
