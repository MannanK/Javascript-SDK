<!DOCTYPE html>
<html>
<head>
<style>

#player-view .play-button.button-enabled,
#player-view .pause-button.button-enabled {
  color: green;
}

#player-view .play-button.button-disabled,
#player-view .pause-button.button-disabled {
  display: none;
}

#player-view .skip-button.button-disabled {
  color: red;
}

#player-view .skip-button.button-enabled {
  color: green;
}

#player-view .track, 
#player-view .release, 
#player-view .artist {
  font-weight: bold;
}

#player-view.state-suspended {
  display: none;
}

</style>
</head>
<body>

<div id="player-view">
<div>
  <span class='position'></span> <span class='status'></span>
</div>
<button class='start-button'>start</button>
<button class='resume-button'>resume</button>
<button class="play-button">play</button>
<button class="pause-button">pause</button>
<button class="skip-button">skip</button>
</div>

<button id='delete'>delete client id</button>
<button id='popout'>popout</button>

<!-- dependencies -->
<script src="../src/config.js" type="application/javascript"></script>
<script src="../vendor/require.js" type="application/javascript"></script>

<script>
  require([ 'feed/feed', 'jquery' ], function(Feed, $) {
    var player = new Feed.Player('7bed4d09839c2743e3eeccd493202fc3d8dd656a', '319f82e863918f6bd3e6d9154a2f22c4ed457441', { debug: true, swfBase: '../dist' });

    $('#delete').on('click', function() {
      // remove any pre-existing client id
      player.session._deleteStoredCid();
    });

    $('#popout').on('click', function() {
      var state = player.suspend();

      // save the current state as a session cookie
      document.cookie = 'player=' + encodeURIComponent(JSON.stringify(state));

      window.open(window.location, '_blank');
    });

    var playerView = new Feed.PlayerView('player-view', player);

    var state = decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)player\s*\=\s*([^;]*).*$)|^.*$/, "$1"));

    if (state) {
      // unsuspend and nuke suspend cookie if it was set
      player.unsuspend(JSON.parse(state), true);
      document.cookie = 'player=; expires=Thu, 01 Jan 1970 00:00:00 GMT';

    } else {
      player.tune();

    }

  });

</script>

</body>
</html>
