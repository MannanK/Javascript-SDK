!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Feed=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";function n(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function r(t){return s[t>>18&63]+s[t>>12&63]+s[t>>6&63]+s[63&t]}function o(t,e,i){for(var n,o=[],s=e;s<i;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push(r(n));return o.join("")}i.byteLength=function(t){return 3*t.length/4-n(t)},i.toByteArray=function(t){var e,i,r,o,s,l=t.length;o=n(t),s=new u(3*l/4-o),i=o>0?l-4:l;var c=0;for(e=0;e<i;e+=4)r=a[t.charCodeAt(e)]<<18|a[t.charCodeAt(e+1)]<<12|a[t.charCodeAt(e+2)]<<6|a[t.charCodeAt(e+3)],s[c++]=r>>16&255,s[c++]=r>>8&255,s[c++]=255&r;return 2===o?(r=a[t.charCodeAt(e)]<<2|a[t.charCodeAt(e+1)]>>4,s[c++]=255&r):1===o&&(r=a[t.charCodeAt(e)]<<10|a[t.charCodeAt(e+1)]<<4|a[t.charCodeAt(e+2)]>>2,s[c++]=r>>8&255,s[c++]=255&r),s},i.fromByteArray=function(t){for(var e,i=t.length,n=i%3,r="",a=[],u=0,l=i-n;u<l;u+=16383)a.push(o(t,u,u+16383>l?l:u+16383));return 1===n?(e=t[i-1],r+=s[e>>2],r+=s[e<<4&63],r+="=="):2===n&&(e=(t[i-2]<<8)+t[i-1],r+=s[e>>10],r+=s[e>>4&63],r+=s[e<<2&63],r+="="),a.push(r),a.join("")};for(var s=[],a=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,h=l.length;c<h;++c)s[c]=l[c],a[l.charCodeAt(c)]=c;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},{}],2:[function(t,e,i){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";function n(t){if(t>j)throw new RangeError("Invalid typed array length");var e=new Uint8Array(t);return e.__proto__=r.prototype,e}function r(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return a(t)}return o(t,e,i)}function o(t,e,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return B(t)?function(t,e,i){if(e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(i||0))throw new RangeError("'length' is out of bounds");var n;n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i);return n.__proto__=r.prototype,n}(t,e,i):"string"==typeof t?function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!r.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var i=0|c(t,e),o=n(i),s=o.write(t,e);s!==i&&(o=o.slice(0,s));return o}(t,e):function(t){if(r.isBuffer(t)){var e=0|l(t.length),i=n(e);return 0===i.length?i:(t.copy(i,0,0,e),i)}if(t){if(T(t)||"length"in t)return"number"!=typeof t.length||R(t.length)?n(0):u(t);if("Buffer"===t.type&&Array.isArray(t.data))return u(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t){return s(t),n(t<0?0:0|l(t))}function u(t){for(var e=t.length<0?0:0|l(t.length),i=n(e),r=0;r<e;r+=1)i[r]=255&t[r];return i}function l(t){if(t>=j)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+j.toString(16)+" bytes");return 0|t}function c(t,e){if(r.isBuffer(t))return t.length;if(T(t)||B(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return I(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return E(t).length;default:if(n)return I(t).length;e=(""+e).toLowerCase(),n=!0}}function h(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if(i>>>=0,e>>>=0,i<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,i){var n=t.length;(!e||e<0)&&(e=0);(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[o]);return r}(this,e,i);case"utf8":case"utf-8":return _(this,e,i);case"ascii":return function(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}(this,e,i);case"latin1":case"binary":return function(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}(this,e,i);case"base64":return function(t,e,i){return 0===e&&i===t.length?O.fromByteArray(t):O.fromByteArray(t.slice(e,i))}(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function f(t,e,i,n,o){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,R(i)&&(i=o?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(o)return-1;i=t.length-1}else if(i<0){if(!o)return-1;i=0}if("string"==typeof e&&(e=r.from(e,n)),r.isBuffer(e))return 0===e.length?-1:p(t,e,i,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):p(t,[e],i,n,o);throw new TypeError("val must be string, number or Buffer")}function p(t,e,i,n,r){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,i/=2}var l;if(r){var c=-1;for(l=i;l<a;l++)if(o(t,l)===o(e,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===u)return c*s}else-1!==c&&(l-=l-c),c=-1}else for(i+u>a&&(i=a-u),l=i;l>=0;l--){for(var h=!0,d=0;d<u;d++)if(o(t,l+d)!==o(e,d)){h=!1;break}if(h)return l}return-1}function y(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(R(a))return s;t[i+s]=a}return s}function g(t,e,i,n){return x(I(e,t.length-i),t,i,n)}function v(t,e,i,n){return x(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function m(t,e,i,n){return v(t,e,i,n)}function b(t,e,i,n){return x(E(e),t,i,n)}function w(t,e,i,n){return x(function(t,e){for(var i,n,r,o=[],s=0;s<t.length&&!((e-=2)<0);++s)i=t.charCodeAt(s),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function _(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o=t[r],s=null,a=o>239?4:o>223?3:o>191?2:1;if(r+a<=i){var u,l,c,h;switch(a){case 1:o<128&&(s=o);break;case 2:128==(192&(u=t[r+1]))&&(h=(31&o)<<6|63&u)>127&&(s=h);break;case 3:u=t[r+1],l=t[r+2],128==(192&u)&&128==(192&l)&&(h=(15&o)<<12|(63&u)<<6|63&l)>2047&&(h<55296||h>57343)&&(s=h);break;case 4:u=t[r+1],l=t[r+2],c=t[r+3],128==(192&u)&&128==(192&l)&&128==(192&c)&&(h=(15&o)<<18|(63&u)<<12|(63&l)<<6|63&c)>65535&&h<1114112&&(s=h)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),r+=a}return function(t){var e=t.length;if(e<=q)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=q));return i}(n)}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,i,n,o,s){if(!r.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function S(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function A(t,e,i,n,r){return e=+e,i>>>=0,r||S(t,0,i,4),U.write(t,e,i,n,23,4),i+4}function C(t,e,i,n,r){return e=+e,i>>>=0,r||S(t,0,i,8),U.write(t,e,i,n,52,8),i+8}function I(t,e){e=e||1/0;for(var i,n=t.length,r=null,o=[],s=0;s<n;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function E(t){return O.toByteArray(function(t){if((t=t.trim().replace(M,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function x(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}function B(t){return t instanceof ArrayBuffer||null!=t&&null!=t.constructor&&"ArrayBuffer"===t.constructor.name&&"number"==typeof t.byteLength}function T(t){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(t)}function R(t){return t!=t}var O=t("base64-js"),U=t("ieee754");i.Buffer=r,i.SlowBuffer=function(t){return+t!=t&&(t=0),r.alloc(+t)},i.INSPECT_MAX_BYTES=50;var j=2147483647;i.kMaxLength=j,(r.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(t,e,i){return o(t,e,i)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(t,e,i){return function(t,e,i){return s(t),t<=0?n(t):void 0!==e?"string"==typeof i?n(t).fill(e,i):n(t).fill(e):n(t)}(t,e,i)},r.allocUnsafe=function(t){return a(t)},r.allocUnsafeSlow=function(t){return a(t)},r.isBuffer=function(t){return null!=t&&!0===t._isBuffer},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,o=0,s=Math.min(i,n);o<s;++o)if(t[o]!==e[o]){i=t[o],n=e[o];break}return i<n?-1:n<i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return r.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=r.allocUnsafe(e),o=0;for(i=0;i<t.length;++i){var s=t[i];if(!r.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},r.byteLength=c,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},r.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},r.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},r.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?_(this,0,t):h.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=i.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t,e,i,n,o){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||i>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=i)return 0;if(n>=o)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,o>>>=0,this===t)return 0;for(var s=o-n,a=i-e,u=Math.min(s,a),l=this.slice(n,o),c=t.slice(e,i),h=0;h<u;++h)if(l[h]!==c[h]){s=l[h],a=c[h];break}return s<a?-1:a<s?1:0},r.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},r.prototype.indexOf=function(t,e,i){return f(this,t,e,i,!0)},r.prototype.lastIndexOf=function(t,e,i){return f(this,t,e,i,!1)},r.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return g(this,t,e,i);case"ascii":return v(this,t,e,i);case"latin1":case"binary":return m(this,t,e,i);case"base64":return b(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var q=4096;r.prototype.slice=function(t,e){var i=this.length;t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var n=this.subarray(t,e);return n.__proto__=r.prototype,n},r.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},r.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||P(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},r.prototype.readUInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*e)),n},r.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||P(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},r.prototype.readInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){t>>>=0,e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt16BE=function(t,e){t>>>=0,e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return t>>>=0,e||P(t,4,this.length),U.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return t>>>=0,e||P(t,4,this.length),U.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return t>>>=0,e||P(t,8,this.length),U.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return t>>>=0,e||P(t,8,this.length),U.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,i,n){if(t=+t,e>>>=0,i>>>=0,!n){k(this,t,e,i,Math.pow(2,8*i)-1,0)}var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},r.prototype.writeUIntBE=function(t,e,i,n){if(t=+t,e>>>=0,i>>>=0,!n){k(this,t,e,i,Math.pow(2,8*i)-1,0)}var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},r.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,1,255,0),this[e]=255&t,e+1},r.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},r.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},r.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},r.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},r.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var r=Math.pow(2,8*i-1);k(this,t,e,i,r-1,-r)}var o=0,s=1,a=0;for(this[e]=255&t;++o<i&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},r.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var r=Math.pow(2,8*i-1);k(this,t,e,i,r-1,-r)}var o=i-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},r.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},r.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},r.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},r.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},r.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},r.prototype.writeFloatLE=function(t,e,i){return A(this,t,e,!0,i)},r.prototype.writeFloatBE=function(t,e,i){return A(this,t,e,!1,i)},r.prototype.writeDoubleLE=function(t,e,i){return C(this,t,e,!0,i)},r.prototype.writeDoubleBE=function(t,e,i){return C(this,t,e,!1,i)},r.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,o=n-i;if(this===t&&i<e&&e<n)for(r=o-1;r>=0;--r)t[r+e]=this[r+i];else if(o<1e3)for(r=0;r<o;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},r.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!r.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0);var s;if("number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var a=r.isBuffer(t)?t:new r(t,n),u=a.length;for(s=0;s<i-e;++s)this[s+e]=a[s%u]}return this};var M=/[^+/0-9A-Za-z-_]/g},{"base64-js":1,ieee754:3}],3:[function(t,e,i){i.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,u=(1<<a)-1,l=u>>1,c=-7,h=i?r-1:0,d=i?-1:1,f=t[e+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+h],h+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)},i.write=function(t,e,i,n,r,o){var s,a,u,l=8*o-r-1,c=(1<<l)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[i+f]=255&a,f+=p,a/=256,r-=8);for(s=s<<r|a,l+=r;l>0;t[i+f]=255&s,f+=p,s/=256,l-=8);t[i+f-p]|=128*y}},{}],4:[function(t,e,i){(function(n){!function(t,n){"object"==typeof i&&void 0!==e?e.exports=n(t):t.moment=n(t)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:this,function(i){"use strict";var n,r=i.Base64;if(void 0!==e&&e.exports)try{n=t("buffer").Buffer}catch(t){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(t){for(var e={},i=0,n=t.length;i<n;i++)e[t.charAt(i)]=i;return e}(o),a=String.fromCharCode,u=function(t){if(t.length<2){return(e=t.charCodeAt(0))<128?t:e<2048?a(192|e>>>6)+a(128|63&e):a(224|e>>>12&15)+a(128|e>>>6&63)+a(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return a(240|e>>>18&7)+a(128|e>>>12&63)+a(128|e>>>6&63)+a(128|63&e)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(l,u)},h=function(t){var e=[0,2,1][t.length%3],i=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[o.charAt(i>>>18),o.charAt(i>>>12&63),e>=2?"=":o.charAt(i>>>6&63),e>=1?"=":o.charAt(63&i)].join("")},d=i.btoa?function(t){return i.btoa(t)}:function(t){return t.replace(/[\s\S]{1,3}/g,h)},f=n?n.from&&n.from!==Uint8Array.from?function(t){return(t.constructor===n.constructor?t:n.from(t)).toString("base64")}:function(t){return(t.constructor===n.constructor?t:new n(t)).toString("base64")}:function(t){return d(c(t))},p=function(t,e){return e?f(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):f(String(t))},y=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),g=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return a(55296+(e>>>10))+a(56320+(1023&e));case 3:return a((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return a((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},v=function(t){return t.replace(y,g)},m=function(t){var e=t.length,i=e%4,n=(e>0?s[t.charAt(0)]<<18:0)|(e>1?s[t.charAt(1)]<<12:0)|(e>2?s[t.charAt(2)]<<6:0)|(e>3?s[t.charAt(3)]:0),r=[a(n>>>16),a(n>>>8&255),a(255&n)];return r.length-=[0,0,2,1][i],r.join("")},b=i.atob?function(t){return i.atob(t)}:function(t){return t.replace(/[\s\S]{1,4}/g,m)},w=n?n.from&&n.from!==Uint8Array.from?function(t){return(t.constructor===n.constructor?t:n.from(t,"base64")).toString()}:function(t){return(t.constructor===n.constructor?t:new n(t,"base64")).toString()}:function(t){return v(b(t))},_=function(t){return w(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};if(i.Base64={VERSION:"2.4.0",atob:b,btoa:d,fromBase64:_,toBase64:p,utob:c,encode:p,encodeURI:function(t){return p(t,!0)},btou:v,decode:_,noConflict:function(){var t=i.Base64;return i.Base64=r,t}},"function"==typeof Object.defineProperty){var P=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};i.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",P(function(){return _(this)})),Object.defineProperty(String.prototype,"toBase64",P(function(t){return p(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",P(function(){return p(this,!0)}))}}return i.Meteor&&(Base64=i.Base64),void 0!==e&&e.exports&&(e.exports.Base64=i.Base64),{Base64:i.Base64}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:2}],5:[function(t,e,i){"use strict";function n(){var t=new RegExp("(?:^|; )@key@=1(?:;|$)");document.cookie="@key@=1";var e=t.test(document.cookie);return e&&a("@key@"),e}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:decodeURIComponent;if("string"!=typeof t||!t)return null;var i=new RegExp("(?:^|; )"+(0,h.escapeRe)(t)+"(?:=([^;]*))?(?:;|$)").exec(document.cookie);return null===i?null:"function"==typeof e?e(i[1]):i[1]}function o(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:decodeURIComponent,e=/(?:^|; )([^=]+?)(?:=([^;]*))?(?:;|$)/g,i={},n=void 0;n=e.exec(document.cookie);)e.lastIndex=n.index+n.length-1,i[n[1]]="function"==typeof t?t(n[2]):n[2];return i}function s(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:encodeURIComponent,n=arguments[3];"object"===(void 0===i?"undefined":c(i))&&null!==i&&(n=i,i=encodeURIComponent);var r=(0,h.convert)(n||{}),o=t+"="+("function"==typeof i?i(e):e)+r;document.cookie=o}function a(t,e){var i={expires:-1};return e&&e.domain&&(i.domain=e.domain),s(t,"a",i)}function u(t){return r(t,null)}function l(t,e,i){return s(t,e,null,i)}i.__esModule=!0,i.removeCookie=i.setRawCookie=i.getRawCookie=i.setCookie=i.getAllCookies=i.getCookie=i.isCookieEnabled=i.remove=i.setRaw=i.getRaw=i.set=i.getAll=i.get=i.isEnabled=void 0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=t("./util");i.isEnabled=n,i.get=r,i.getAll=o,i.set=s,i.getRaw=u,i.setRaw=l,i.remove=a,i.isCookieEnabled=n,i.getCookie=r,i.getAllCookies=o,i.setCookie=s,i.getRawCookie=u,i.setRawCookie=l,i.removeCookie=a},{"./util":6}],6:[function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function r(t){var e=t.charAt(t.length-1),i=parseInt(t,10),n=new Date;switch(e){case"Y":n.setFullYear(n.getFullYear()+i);break;case"M":n.setMonth(n.getMonth()+i);break;case"D":n.setDate(n.getDate()+i);break;case"h":n.setHours(n.getHours()+i);break;case"m":n.setMinutes(n.getMinutes()+i);break;case"s":n.setSeconds(n.getSeconds()+i);break;default:n=new Date(t)}return n}i.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.hasOwn=n,i.escapeRe=function(t){return t.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")},i.computeExpires=r,i.convert=function(t){var e="";for(var i in t)if(n(t,i))if(/^expires$/i.test(i)){var s=t[i];"object"!==(void 0===s?"undefined":o(s))&&(s=r(s+="number"==typeof s?"D":"")),e+=";"+i+"="+s.toUTCString()}else/^secure$/.test(i)?t[i]&&(e+=";"+i):e+=";"+i+"="+t[i];return n(t,"path")||(e+=";path=/"),e}},{}],7:[function(t,e,i){(function(t){var i="undefined"!=typeof window?window._:void 0!==t?t._:null,n=Array.prototype.slice,r={on:function(t,e,i){if(!s(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});return(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!s(this,"once",t,[e,n])||!e)return this;var r=this,o=i.once(function(){r.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,n)},off:function(t,e,n){var r,o,a,u,l,c,h,d;if(!this._events||!s(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(l=0,c=(u=t?[t]:i.keys(this._events)).length;l<c;l++)if(t=u[l],a=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,d=a.length;h<d;h++)o=a[h],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=n.call(arguments,1);if(!s(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&a(i,e),r&&a(r,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var r=!e&&!i;"object"==typeof e&&(i=this),t&&((n={})[t._listenerId]=t);for(var o in n)n[o].off(e,i,this),r&&delete this._listeners[o];return this}},o=/\s+/,s=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(o.test(i)){for(var s=i.split(o),a=0,u=s.length;a<u;a++)t[e].apply(t,[s[a]].concat(n));return!1}return!0},a=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e)}};i.each({listenTo:"on",listenToOnce:"once"},function(t,e){r[e]=function(e,n,r){return(this._listeners||(this._listeners={}))[e._listenerId||(e._listenerId=i.uniqueId("l"))]=e,"object"==typeof n&&(r=this),e[t](n,r,this),this}}),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e,i){/*! A Feed.fm joint: github.com/fuzz-radio/Javascript-SDK */
var n=t("./session"),r=t("./nolog"),o=t("./player-view"),s=t("./player"),a=t("./speaker"),u=t("./version");e.exports={Session:n,Player:s,PlayerView:o,log:r,version:u,_getSpeaker:a}},{"./nolog":9,"./player":11,"./player-view":10,"./session":12,"./speaker":13,"./version":15}],9:[function(t,e,i){e.exports=function(){}},{}],10:[function(t,e,i){(function(t){function i(t){var e=Math.floor(t/1e3),i=e%60,n=Math.floor(e/60);return i<10&&(i="0"+i),n+":"+i}var n="undefined"!=typeof window?window._:void 0!==t?t._:null,r="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,o=function(t,e){this.id=t,this.alertId=null,this.durationId=null,this.startedPlayback=!1,this.$el=r("#"+t),this.player=e,this.player.on("placement",this._onPlacement,this),this.player.on("play-started",this._onPlayStarted,this),this.player.on("play-paused",this._onPlayPaused,this),this.player.on("play-resumed",this._onPlayResumed,this),this.player.on("play-completed",this._onPlayCompleted,this),this.player.on("play-liked",this._onPlayLiked,this),this.player.on("play-unliked",this._onPlayUnliked,this),this.player.on("play-disliked",this._onPlayDisliked,this),this.player.on("plays-exhausted",this._onPlaysExhausted,this),this.player.on("skip-denied",this._onSkipDenied,this),this.player.on("suspend",this._onSuspend,this),this._enableButtonsBasedOnState(),this.displayText=this.originalDisplayText=this.$(".status").html(),this.renderStatus(),this.$el.on("click",".status",n.bind(this._onStatusClick,this)),this.$el.on("click",".play-button, .start-button, .resume-button",n.bind(this._onPlayButtonClick,this)),this.$el.on("click",".pause-button",n.bind(this._onPauseButtonClick,this)),this.$el.on("click",".skip-button",n.bind(this._onSkipButtonClick,this)),this.$el.on("click",".like-button",n.bind(this._onLikeButtonClick,this)),this.$el.on("click",".dislike-button",n.bind(this._onDislikeButtonClick,this))};o.prototype._onStatusClick=function(){"playing"===this.player.getCurrentState()?this._onPauseButtonClick():this._onPlayButtonClick()},o.prototype._onPlayButtonClick=function(){this.player.initializeAudio(),this.player.play()},o.prototype._onPauseButtonClick=function(){this.player.pause()},o.prototype._onSkipButtonClick=function(){this.player.skip()},o.prototype._onLikeButtonClick=function(t){r(t.target).closest(".like-button").is(".liked")?this.player.unlike():this.player.like()},o.prototype._onDislikeButtonClick=function(){this.player.dislike()},o.prototype.$=function(t){return this.$el.find(t)},o.prototype._onPlacement=function(t){this.originalDisplayText||(this.originalDisplayText=this.formatPlacement(t),this.renderStatus(this.originalDisplayText))},o.prototype.formatPlacement=function(t){return"Tune in to <em class='placement'>"+t.name+"</em>"},o.prototype._onPlayStarted=function(t){this.startedPlayback=!0,this.renderStatus(this.formatPlay(t)),this._enableButtonsBasedOnState(),this._setLikeStatus(t.liked),this._enablePositionTracker()},o.prototype._enablePositionTracker=function(){var t=this;this.durationId||(this.durationId=window.setInterval(function(){t.renderPosition(t.player.getPosition(),t.player.getDuration())},500))},o.prototype._setLikeStatus=function(t){!0===t?(this.$(".like-button").addClass("liked"),this.$(".dislike-button").removeClass("disliked")):!1===t?(this.$(".like-button").removeClass("liked"),this.$(".dislike-button").addClass("disliked")):(this.$(".like-button").removeClass("liked"),this.$(".dislike-button").removeClass("disliked"))},o.prototype._disablePositionTracker=function(){this.durationId&&(window.clearInterval(this.durationId),this.durationId=null)},o.prototype._onPlayResumed=function(){this._enablePositionTracker(),this._enableButtonsBasedOnState()},o.prototype._onPlayPaused=function(){this._disablePositionTracker(),this._enableButtonsBasedOnState()},o.prototype._onPlayCompleted=function(){this.renderPosition(0,0),this._enableButtonsBasedOnState()},o.prototype._onPlaysExhausted=function(){this.renderStatus(this.originalDisplayText),this.renderAlert("There is no more music to play in this station!"),this._enableButtonsBasedOnState()},o.prototype._onPlayLiked=function(){this._setLikeStatus(!0)},o.prototype._onPlayDisliked=function(){this._setLikeStatus(!1)},o.prototype._onPlayUnliked=function(){this._setLikeStatus()},o.prototype._onSkipDenied=function(){this.renderAlert("Sorry you've temporarily run out of skips!")},o.prototype.formatPlay=function(t){return"<span class='track'>"+t.audio_file.track.title+"</span> by <span class='artist'>"+t.audio_file.artist.name+"</span> on <span class='release'>"+t.audio_file.release.title+"</span>"},o.prototype.renderStatus=function(t){void 0!==t&&(this.displayText=t),this.alertId||this.$(".status").html(this.displayText).removeClass("alert")},o.prototype.renderPosition=function(t,e){if(this.$(".elapsed").html(i(t)),this.$(".duration").html(i(e)),0===e)this.$(".progress").css("width","0");else{var n=Math.round((t+1e3)/e*100);n=n>100?100:n,this.$(".progress").css("width",n+"%")}},o.prototype.renderAlert=function(t){this.alertId&&window.clearTimeout(this.alertId),this.$(".status").html(t).addClass("alert");var e=this;this.alertId=window.setTimeout(function(){e.alertId=null,e.renderStatus()},3e3)},o.prototype._onSuspend=function(){this._enableButtonsBasedOnState()},o.prototype._enableButtonsBasedOnState=function(){var t,e,i=this.player.getCurrentState();switch(i){case"playing":t=".pause-button, .like-button, .dislike-button",e=".play-button, .start-button, .resume-button",this.player.maybeCanSkip()?t+=", .skip-button":e+=", .skip-button";break;case"paused":t=".play-button, .resume-button, .like-button, .dislike-button",e=".pause-button, .start-button",this.player.maybeCanSkip()?t+=", .skip-button":e+=", .skip-button";break;case"suspended":t="",e=".play-button, .resume-button, .like-button, .dislike-button, .pause-button, .start-button, .skip-button";break;default:t=".play-button, .start-button",e=".resume-button, .pause-button, .like-button, .dislike-button, .skip-button"}this.$(e).removeClass("button-enabled").addClass("button-disabled").attr("disabled","true"),t&&this.$(t).removeClass("button-disabled").addClass("button-enabled").removeAttr("disabled"),this.$el.removeClass("state-playing state-paused state-idle state-suspended").addClass("state-"+i)},e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(t,e,i){(function(i){function n(){try{return"localStorage"in window&&null!==window.localStorage&&(window.localStorage["feed-test"]=!0)}catch(t){return!1}}var r="undefined"!=typeof window?window._:void 0!==i?i._:null,o="undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null,s=t("./nolog"),a=t("./speaker"),u=t("./events"),l=t("./session"),c=function(t,e,i){this.state={paused:!0,suspended:!1},i=i||{},this.trimming=i.trimming||!1,this.normalizeVolume=i.normalizeVolume||!0,this.secondsOfCrossfade=i.secondsOfCrossfade||0,this.crossfadeIn=i.crossfadeIn||!1,r.extend(this,u);var n=this.session=new l(t,e,i);this.session.on("play-active",this._onPlayActive,this),this.session.on("play-started",this._onPlayStarted,this),this.session.on("play-completed",this._onPlayCompleted,this),this.session.on("plays-exhausted",this._onPlaysExhausted,this),this.session.on("prepare-sound",this._onPrepareSound,this),this.session.on("all",function(){this.trigger.apply(this,Array.prototype.slice.call(arguments,0))},this);var s=this.initializeSpeaker=o.Deferred();this.speaker=a(i,function(t){if(i.formats){var e=i.formats.split(","),o=t.split(","),a=r.intersection(e,o),u=a.join(",");0===a.length&&(u=t),n.setFormats(u)}else n.setFormats(t);s.resolve()}),this.setMuted(this.isMuted())};c.prototype.initializeAudio=function(){var t=this;this.initializeSpeaker.then(function(){t.speaker.initializeAudio()})},c.prototype.setPlacementId=function(t){this.session.setPlacementId(t)},c.prototype.setStationId=function(t){this.session.setStationId(t)},c.prototype.setBaseUrl=function(t){this.session.setBaseUrl(t)},c.prototype._onPlayActive=function(t){var e={play:r.bind(this._onSoundPlay,this,t.id),pause:r.bind(this._onSoundPause,this,t.id),finish:r.bind(this._onSoundFinish,this,t.id),elapse:r.bind(this._onSoundElapse,this,t.id)};this.normalizeVolume&&(e.gain=(t.audio_file.replaygain_track_gain||0)+(t.station.pre_gain||0)),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_start&&(e.startPosition=1e3*t.audio_file.extra.trim_start),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_end&&t.audio_file.duration_in_seconds&&(e.endPosition=1e3*(t.audio_file.duration_in_seconds-t.audio_file.extra.trim_end)),this.secondsOfCrossfade&&(this.crossfadeIn&&(e.fadeInSeconds=this.secondsOfCrossfade),e.fadeOutSeconds=this.secondsOfCrossfade);var i=this.speaker.create(t.audio_file.url,e);if(this.state.activePlay={id:t.id,sound:i,startReportedToServer:!1,soundCompleted:!1,playStarted:!1,previousPosition:0},!this.state.paused){this.state.activePlay.sound.play()}},c.prototype._onSoundPlay=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){if(this.state.paused=!1,this.state.activePlay.playStarted=!0,!this.state.activePlay.startReportedToServer)return this.session.reportPlayStarted();this.trigger("play-resumed",this.session.getActivePlay())}else s("received sound play, but active play does not match",this.state.activePlay,t)},c.prototype.getActivePlay=function(){return this.session.getActivePlay()},c.prototype.hasActivePlayStarted=function(){return this.session.hasActivePlayStarted()},c.prototype.getActivePlacement=function(){return this.session.getActivePlacement()},c.prototype._onSoundPause=function(t){this.state.activePlay&&this.state.activePlay.id===t?(this.state.paused=!0,this.trigger("play-paused",this.session.getActivePlay())):s("received sound pause, but active play does not match",this.state.activePlay,t)},c.prototype._onSoundFinish=function(t,e){this.state.activePlay&&this.state.activePlay.id===t?(this.state.activePlay.soundCompleted=!0,e&&(this.state.activePlay.soundCompletedWithError=!0),this.state.activePlay.playStarted?this.state.activePlay.startReportedToServer&&(e?(s("song completed with error - marking as invalid"),this.session.requestInvalidate()):this.session.reportPlayCompleted()):this.session.requestInvalidate()):s("received sound finish, but active play does not match",this.state.activePlay,t)},c.prototype._onSoundElapse=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){var e=this.state.activePlay.sound.position(),i=Math.floor(this.state.activePlay.previousPosition/3e4),n=Math.floor(e/3e4);this.state.activePlay.previousPosition=e,n!==i&&this.session.reportPlayElapsed(Math.floor(e/1e3))}else s("received sound elapse, but active play does not match",this.state.activePlay,t)},c.prototype._onPlayStarted=function(t){var e=this.session;this.state.activePlay&&this.state.activePlay.id===t.id?(this.state.activePlay.startReportedToServer=!0,this.state.activePlay.soundCompleted&&(s("sound completed before we finished reporting start",this.state.activePlay),this.state.activePlay.soundCompletedWithError?r.defer(function(){e.requestInvalidate()}):r.defer(function(){e.reportPlayCompleted()}))):s("received play started, but it does not match active play",t,this.state.activePlay)},c.prototype._onPlayCompleted=function(t){this.state.activePlay&&this.state.activePlay.id===t.id?(this.state.activePlay.sound.destroy(),delete this.state.activePlay):s("received play completed, but it does not match active play",t,this.state.activePlay)},c.prototype._onPlaysExhausted=function(){this.state.paused=!1},c.prototype._onPrepareSound=function(t){s("preparing",t),this.speaker.prepare(t)},c.prototype.isPaused=function(){return this.session.isTuned()&&this.state.paused},c.prototype.getStationInformation=function(t){return this.session.getStationInformation(t)},c.prototype.tune=function(){var t=this;this.initializeSpeaker.then(function(){t.session.isTuned()||t.session.tune()})},c.prototype.play=function(){var t=this;this.initializeSpeaker.then(function(){if(!t.session.isTuned())return t.state.paused=!1,t.session.tune();t.session.getActivePlay()&&t.state.activePlay&&t.state.paused?t.state.activePlay.playStarted?t.state.activePlay.sound.resume():t.state.activePlay.sound.play():t.state.paused=!1})},c.prototype.pause=function(){this.session.hasActivePlayStarted()&&this.state.activePlay&&!this.state.paused&&this.state.activePlay.sound.pause()},c.prototype.like=function(){this.session.hasActivePlayStarted()&&(this.session.likePlay(this.state.activePlay.id),this.trigger("play-liked"))},c.prototype.unlike=function(){this.session.hasActivePlayStarted()&&(this.session.unlikePlay(this.state.activePlay.id),this.trigger("play-unliked"))},c.prototype.dislike=function(){this.session.hasActivePlayStarted()&&(this.session.dislikePlay(this.state.activePlay.id),this.trigger("play-disliked"),this.state.paused=!1,this.skip())},c.prototype.skip=function(){this.session.hasActivePlayStarted()&&(this.state.paused=!1,this.session.requestSkip())},c.prototype.destroy=function(){this.session=null,this.state.activePlay&&this.state.activePlay.sound&&this.state.activePlay.sound.destroy()},c.prototype.getCurrentState=function(){return this.state.suspended?"suspended":this.session.hasActivePlayStarted()?this.state.paused?"paused":"playing":"idle"},c.prototype.getPosition=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.position():0},c.prototype.getDuration=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.duration():0},c.prototype.maybeCanSkip=function(){return this.session.maybeCanSkip()};c.prototype.isMuted=function(){return!!(n()&&"muted"in localStorage)&&"true"===localStorage.muted},c.prototype.setMuted=function(t){t?(this.speaker.setVolume(0),n()&&(localStorage.muted=!0),this.trigger("muted")):(this.speaker.setVolume(100),n()&&(localStorage.muted=!1),this.trigger("unmuted"))},c.prototype.suspend=function(){var t=this.state.activePlay&&this.state.activePlay.sound,e=this.session.suspend(t?this.state.activePlay.sound.position():0);return this.pause(),this.state.suspended=!0,this.trigger("suspend"),e},c.prototype.unsuspend=function(t,e){this.session.unsuspend(t),e&&this.play()},e.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./events":7,"./nolog":9,"./session":12,"./speaker":13}],12:[function(t,e,i){(function(i){function n(t,e,i){(t=t?2*t:200)>e&&(t=e),setTimeout(function(){i(t)},t)}var r="undefined"!=typeof window?window._:void 0!==i?i._:null,o="undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null,s=t("./nolog"),a=t("./events"),u=t("./util"),l=t("js-base64").Base64,c=t("tiny-cookie"),h=t("./version"),d=function(t,e,i){i=i||{},this.config={baseUrl:u.addProtocol(i.baseUrl||"//feed.fm",!0),formats:"mp3,aac",maxBitrate:128,timeOffset:0,current:null,pendingRequest:null,pendingPlay:null},r.extend(this,a),t&&e&&this.setCredentials(t,e)};d.prototype.setBaseUrl=function(t){this.config.baseUrl=u.addProtocol(t)},d.prototype.setCredentials=function(t,e){this.config.token=t,this.config.secret=e},d.prototype.setPlacementId=function(t){this.config.placementId=t,this.trigger("placement-changed",t),this._retune()},d.prototype.setStationId=function(t){this.config.stationId!=t&&(this.config.stationId=t,this.trigger("station-changed",t),this._retune())},d.prototype.setFormats=function(t){this.config.formats=t,this._retune()},d.prototype.setMaxBitrate=function(t){this.config.maxBitrate=t},d.prototype.tune=function(){if(!this.config.token)throw new Error("no token set with setCredentials()");if(!this.config.secret)throw new Error("no secret set with setCredentials()");this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0),this._getDefaultPlacementInformation()},d.prototype._getDefaultPlacementInformation=function(t){if(this.config.placementId&&this.config.placement&&this.config.placement.id===this.config.placementId)this._requestNextPlay();else{var e={url:this.config.baseUrl+"/api/v2/placement",type:"GET",data:{client_id:this.config.clientId},dataType:"json",timeout:6e3};s("requesting default placement information from server"),this._signedAjax(e).done(r.bind(this._receiveDefaultPlacementInformation,this)).fail(r.bind(this._failedDefaultPlacementInformation,this,t))}},d.prototype._receiveDefaultPlacementInformation=function(t){t&&t.success&&t.placement&&(this.config.placement=t.placement,this.config.stations=t.stations,this.config.placementId=t.placement.id,this.trigger("placement-changed",this.config.placementId),this.trigger("placement",t.placement),!("stationId"in this.config)&&t.stations.length>0&&(this.config.stationId=t.stations[0].id,this.trigger("station-changed",this.config.stationId)),this.trigger("stations",t.stations),this._requestNextPlay())},d.prototype._failedDefaultPlacementInformation=function(t,e){if(401===e.status)try{var i=o.parseJSON(e.responseText);if(i.error&&5===i.error.code)return void this.trigger("invalid-credentials")}catch(t){}t=t?2*t:500,r.delay(r.bind(this._getDefaultPlacementInformation,this,t),t)},d.prototype.getActivePlacement=function(){return this.config.placement?this.config.placement:null},d.prototype.getActivePlay=function(){return this.config.current?this.config.current.play:null},d.prototype.isTuned=function(){return this.config.current||this.config.pendingRequest},d.prototype.hasActivePlayStarted=function(){return this.config.current&&this.config.current.started},d.prototype._retune=function(){this.isTuned()&&this.tune()},d.prototype.reportPlayStarted=function(){if(!this.config.current)throw new Error("attempt to report a play started, but there is no active play");this._startPlay(this.config.current.play)},d.prototype.reportPlayElapsed=function(t){if(!this.config.current)throw new Error("attempt to report elapsed play time, but the play hasn't started");this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/elapse",type:"POST",data:{seconds:t}})},d.prototype.reportPlayCompleted=function(){if(!this.config.current||!this.config.current.started)throw s("finish on non-active or playing song"),new Error("no active or playing song");this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/complete",type:"POST"}).always(r.bind(this._receivePlayCompleted,this))},d.prototype._receivePlayCompleted=function(){if(this.config.pendingRequest)s("song finished, but we're still waiting for next one to return"),this._assignCurrentPlay(null,!0);else{s("song finished, and no outstanding request, so playing pendingPlay");var t=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(t)}},d.prototype.requestSkip=function(){if(!this.config.current)throw new Error("No song being played");if(!this.config.current.started)throw new Error("No song has been started");this.config.current.canSkip?this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/skip",type:"POST"}).done(r.bind(this._receiveSkip,this,this.config.current.play)).fail(r.bind(this._failSkip,this,this.config.current.play)):this.trigger("skip-denied")},d.prototype.requestInvalidate=function(){if(!this.config.current)throw new Error("No active song to invalidate!");this._sendInvalidate(this.config.current.play)},d.prototype._sendInvalidate=function(t,e){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t.id+"/invalidate",type:"POST"}).done(r.bind(this._receiveInvalidate,this,t)).fail(r.bind(this._failInvalidate,this,e,t))},d.prototype._failInvalidate=function(t,e,i){var n=this;(t=t?2*t:200)<3e3?r.delay(function(){n._sendInvalidate(e)},t):s("gave up trying to invalidate play",i)},d.prototype._receiveInvalidate=function(t,e){if(this.config.current&&this.config.current.play===t)if(e.success)if(this.config.pendingPlay){s("invalidating to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else s("invalidating current song"),this._assignCurrentPlay(null,!0),this.config.pendingRequest||(s("queueing up new song"),this._requestNextPlay());else s("failed invalidate! - technically this is impossible")},d.prototype._failSkip=function(t){this.config.current&&this.config.current.play===t&&this.trigger("skip-denied")},d.prototype._receiveSkip=function(t,e){if(this.config.current&&this.config.current.play===t){if(!e.success)return s("failed skip!"),void this.trigger("skip-denied");if(this.config.pendingPlay){s("skipping to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else this.config.pendingRequest?(s("skipping to what is queued up"),this._assignCurrentPlay(null,!0)):(s("skipping to what is queued up"),this._assignCurrentPlay(null))}},d.prototype._startPlay=function(t){this.config.current.retryCount>2?this._receiveStartPlay(t,{success:!0,can_skip:!0}):(s("telling server we're starting the play",t),this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t.id+"/start",type:"POST",dataType:"json",timeout:3e3}).done(r.bind(this._receiveStartPlay,this,t)).fail(r.bind(this._failStartPlay,this,t)))},d.prototype._receiveStartPlay=function(t,e){e.success?this.config.current&&this.config.current.play===t?(this.config.current.canSkip=e.can_skip,this.config.current.started=!0,this.trigger("play-started",t),this._requestNextPlay()):s("received start play, but not waiting any more"):s("received failed start success")},d.prototype._failStartPlay=function(t,e){if(this.config.current&&this.config.current.play===t){if(403===e.status)try{var i=o.parseJSON(e.responseText);if(i.error&&20===i.error.code)return this._receiveStartPlay(t,{success:!0,can_skip:!0})}catch(t){s("unable to parse start play response",t.message)}s("request failed - trying again in 1 second",e.status),this.config.current.retryCount++,r.delay(r.bind(this._startPlay,this,t),1e3)}else s("startPlay failed, but we don't care any more")},d.prototype._assignCurrentPlay=function(t,e){this.config.current&&(this.trigger("play-completed",this.config.current.play),this.config.current=null),null===t?e?s("nothing to play... waiting"):(s("nothing to play from the current station"),this.trigger("plays-exhausted")):(this.config.current={play:t,canSkip:!1,started:!1,retryCount:0},s("activated new song"),this.trigger("play-active",t))},d.prototype._requestNextPlay=function(t){var e=this;this._getClientId().then(function(){if(e.config.pendingRequest)return t?t>6e4?(s("giving up on retrieving next play"),e.config.pendingRequest=null,void(null==e.config.current&&e._assignCurrentPlay(null))):(s("retrying pending request"),e.config.pendingRequest.retryCount++,void e._signedAjax(e.config.pendingRequest.ajax).done(r.bind(e._receiveNextPlay,e,e.config.pendingRequest.ajax)).fail(r.bind(e._failedNextPlay,e,t,e.config.pendingRequest.ajax))):void s("already waiting for a request to finish");var i={url:e.config.baseUrl+"/api/v2/play",type:"POST",dataType:"json",timeout:6e3,data:{formats:e.config.formats,client_id:e.config.clientId,max_bitrate:e.config.maxBitrate,secure:!0}};e.config.placementId&&(i.data.placement_id=e.config.placementId),e.config.stationId&&(i.data.station_id=e.config.stationId),e.config.pendingRequest={ajax:i,retryCount:0},s("requesting new play from server",i),e._signedAjax(i).done(r.bind(e._receiveNextPlay,e,i)).fail(r.bind(e._failedNextPlay,e,t,i))})},d.prototype._receiveNextPlay=function(t,e){this.config.pendingRequest&&this.config.pendingRequest.ajax===t?(this.config.pendingRequest=null,e.success?(this.trigger("prepare-sound",e.play.audio_file.url),this.config.current?(s("received play, but we're already playing, so queueing up",e.play),this.config.pendingPlay=e.play):(s("received play and no current song, so playing now",e.play),this._assignCurrentPlay(e.play))):e.error&&9===e.error.code?this.config.current?(s("ran out of music to play, but we're already playing"),this.config.pendingPlay=null):(s("ran out of music, and nothing playing now"),this.trigger("plays-exhausted")):s("unsuccessful response",e)):s("nextPlay succeeded, but we don't care")},d.prototype._failedNextPlay=function(t,e,i){if(this.config.pendingRequest&&this.config.pendingRequest.ajax===e){if(403===i.status)try{var n=o.parseJSON(i.responseText);if(n.error&&19===n.error.code)return void this.trigger("not-in-us",n.error.message)}catch(t){s("problem parsing 403 response",t.message)}s("request failed - trying again",i.status),t=t?2*t:500,r.delay(r.bind(this._requestNextPlay,this,t),t)}else s("nextPlay failed, but we don't care")},d.prototype._getClientId=function(){if(this.clientPromise)return this.clientPromise;var t=new o.Deferred;this.clientPromise=t.promise();var e=this;return this._requestClientId(function(i){e.config.clientId=i,e._setStoredCid(e.config.clientId),t.resolve(i)}),this.clientPromise},d.prototype._requestClientId=function(t,e){var i=this._getStoredCid();if(i)return t(i);var r=this;this._signedAjax({url:r.config.baseUrl+"/api/v2/client",type:"POST"}).done(function(i){i.success?t(i.client_id):n(e,2e3,function(e){r._requestClientId(t,e)})}).fail(function(i){if(403===i.status)try{var a=o.parseJSON(i.responseText);if(a.error&&19===a.error.code)return void r.trigger("not-in-us",a.error.message)}catch(t){s("unknown response for client id request",t.message)}else s("unknown client id response status",i.status);n(e,2e3,function(e){r._requestClientId(t,e)})})},d.prototype.maybeCanSkip=function(){return this.config.current&&this.config.current.started&&this.config.current.canSkip},d.prototype.likePlay=function(t){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t+"/like",type:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!0)},d.prototype.unlikePlay=function(t){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t+"/like",type:"DELETE"}),this.config.current&&this.config.current.play.id===t&&delete this.config.current.play.liked},d.prototype.dislikePlay=function(t){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t+"/dislike",type:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!1)},d.prototype.suspend=function(t){var e={};return this.config.placementId&&(e.placementId=this.config.placementId),this.config.stationId&&(e.stationId=this.config.stationId),this.config.current&&this.config.current.started&&(e.placement=this.config.placement,e.stations=this.config.stations,e.play=r.clone(this.config.current.play),e.play.startPosition=t,e.canSkip=this.config.current.canSkip),e},d.prototype.unsuspend=function(t){if(this.getActivePlay())throw new Error("You cannot unsuspend after running tune()");return"placementId"in t&&(this.config.placementId=t.placementId,this.trigger("placement-changed",this.config.placementId)),"stationId"in t&&(this.config.stationId=t.stationId,this.trigger("station-changed",this.config.stationId)),"play"in t?(this.config.placement=t.placement,this.config.stations=t.stations,this.trigger("placement",this.config.placement),this.trigger("stations",this.config.stations),this._assignCurrentPlay(t.play),this._receiveStartPlay(t.play,{success:!0,can_skip:t.canSkip}),t.play):(this.tune(),null)};d.prototype._getStoredCid=function(){return c.get("cid")},d.prototype._setStoredCid=function(t){c.set("cid",t,{expires:3650,path:"/"})},d.prototype._deleteStoredCid=function(){o.removeCookie("cid",{path:"/"})},d.prototype._sign=function(t){var e;return e="Basic "+l.encode(this.config.token+":"+this.config.secret),t.headers={Authorization:e},t.headers["X-Feed-SDK"]=h,t},d.prototype._signedAjax=function(t){return this._ajax(this._sign(t))},d.prototype._ajax=function(t){return o.ajax(t)},e.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./events":7,"./nolog":9,"./util":14,"./version":15,"js-base64":4,"tiny-cookie":5}],13:[function(t,e,i){(function(i){function n(t){return" src = "+t.src+", time = "+t.currentTime+", paused = "+t.paused+", duration = "+t.duration+", readyState = "+t.readyState}var r="undefined"!=typeof window?window._:void 0!==i?i._:null,o=("undefined"!=typeof window?window.jQuery:void 0!==i&&i.jQuery,t("./nolog")),s=t("./events"),a=(t("./util"),t("./version"),/(iPhone|iPad)/i.test(navigator.userAgent)),u=a?"https://u9e9h7z5.map2.ssl.hwcdn.net/feedfm-audio/250-milliseconds-of-silence.mp3":"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",l=function(t,e,i,n){var o=r.extend(this,s);return o.id=i,o.url=n,o.speaker=t,o.loaded=!1,e?(this.startPosition=+e.startPosition,this.endPosition=+e.endPosition,this.fadeInSeconds=+e.fadeInSeconds,this.fadeInSeconds?(this.fadeInStart=this.startPosition?this.startPosition/1e3:0,this.fadeInEnd=this.fadeInStart+this.fadeInSeconds):(this.fadeInStart=0,this.fadeInEnd=0),this.fadeOutSeconds=+e.fadeOutSeconds,this.fadeOutSeconds&&(this.endPosition?(this.fadeOutStart=this.endPosition/1e3-this.fadeOutSeconds,this.fadeOutEnd=this.endPosition/1e3):(this.fadeOutStart=0,this.fadeOutEnd=0)),r.each(["play","pause","finish","elapse"],function(t){t in e&&o.on(t,e[t])}),this.gain=e.gain||0):this.gain=0,o};l.prototype={play:function(){return o(this.id+" sound play"),this.speaker._playSound(this)},pause:function(){return o(this.id+" sound pause"),this.speaker._pauseSound(this)},resume:function(){return o(this.id+" sound resume"),this.speaker._playSound(this)},position:function(){return this.speaker._position(this)},duration:function(){return this.speaker._duration(this)},destroy:function(){o(this.id+" being called to destroy"),this.speaker._destroySound(this)},gainAdjustedVolume:function(t){if(!this.gain)return o("no volume adjustment"),t/100;return Math.max(Math.min(t/100*(50*Math.pow(10,this.gain/20)),100),0)/100}};var c=function(t){document.createElement("audio");document.createElement("audio").canPlayType("audio/aac")?this.preferred="aac,mp3":this.preferred="mp3"};c.prototype={vol:100,outstandingPlays:{},audioContext:null,active:null,fading:null,preparing:null,prepareWhenReady:null,initializeAudio:function(){null===this.active?(o("initializing for mobile"),this.audioContext=function(){var t=window.AudioContext||window.webkitAudioContext;desiredSampleRate=44100;var e=new t;if(e.sampleRate!==desiredSampleRate){var i=e.createBuffer(1,1,desiredSampleRate),n=e.createBufferSource();n.buffer=i,n.connect(e.destination),n.start(0),n.disconnect(),e.close(),e=new t}return e}(),this.active=this._createAudio(u),this.fading=this._createAudio(u),this.preparing=this._createAudio(this.prepareWhenReady?this.prepareWhenReady:u),this.prepareWhenReady=null):o("mobile already initialized")},_createAudioGainNode:function(t){var e=this.audioContext.createMediaElementSource(t),i=this.audioContext.createGain();return i.gain.value=1,e.connect(i),i.connect(this.audioContext.destination),i.gain},_createAudio:function(t){var e=new Audio(t);e.crossOrigin="anonymous",e.loop=!1,e.volume=1,this._addEventListeners(e);var i=null;if(a){var n=this.audioContext.createMediaElementSource(e),r=this.audioContext.createGain();r.gain.value=1,n.connect(r),r.connect(this.audioContext.destination),i=r.gain}return{audio:e,sound:null,gain:i,volume:1}},_addEventListeners:function(t){t.addEventListener("pause",r.bind(this._onAudioPauseEvent,this)),t.addEventListener("ended",r.bind(this._onAudioEndedEvent,this)),t.addEventListener("timeupdate",r.bind(this._onAudioTimeUpdateEvent,this))},_onAudioPauseEvent:function(t){var e=t.currentTarget;e.src!==u&&e===this.active.audio&&e.currentTime!==e.duration&&(this.active.sound&&this.active.sound.url===e.src?this.active.sound.trigger("pause"):o("active audio pause, but no matching sound"))},_onAudioEndedEvent:function(t){var e=t.currentTarget;if(e.src!==u){if(e===this.fading.audio)return e.src=u,void(this.fading.sound=null);if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){o("active audio ended");var i=this.active.sound;this.active.sound=null,i.trigger("finish")}else o("active audio ended, but no matching sound",e.src)}},_onAudioTimeUpdateEvent:function(t){var e=t.currentTarget;if(e.src!==u)if(e===this.fading.audio&&this.fading.sound)this.fading.sound.endPosition&&e.currentTime>=this.fading.sound.endPosition/1e3?(this.fading.sound=null,this.fading.audio.src=u):this._setVolume(this.fading);else if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){if(this.active.sound.endPosition&&this.active.sound.endPosition/1e3<=e.currentTime){var i=this.active.sound;this.active.sound=null,this.active.audio.src=u,i.trigger("finish")}else if(this.active.sound.fadeOutEnd&&e.currentTime>=this.active.sound.fadeOutStart){this._setVolume(this.active);var n=this.fading;this.fading=this.active,this.active=n,this.active.sound=null,this.fading.sound.trigger("finish")}else o("elapse volume"),this._setVolume(this.active),this.active.sound.trigger("elapse");this.prepareWhenReady&&this.prepare(this.prepareWhenReady)}else o("active audio elapsed, but it no matching sound")},_setVolume:function(t,e){e||(e=t.sound);var i=t.audio.currentTime,n=t.volume,r=e.gainAdjustedVolume(this.vol);e.fadeInStart!=e.fadeInEnd&&i<e.fadeInStart?(r=0,o("pre-fade-in volume is 0")):e.fadeInStart!=e.fadeInEnd&&i>=e.fadeInStart&&i<=e.fadeInEnd?(r=(i-e.fadeInStart)/(e.fadeInEnd-e.fadeInStart)*r,o("ramping \u25b2 volume",{currentTime:i,currentVolume:n,calculatedVolume:r,sound:e})):e.fadeOutStart!=e.fadeOutEnd&&i>e.fadeOutEnd?(r=0,o("post-fade-out volume is 0")):e.fadeOutStart!=e.fadeOutEnd&&i>=e.fadeOutStart&&i<=e.fadeOutEnd?(r=(1-(i-e.fadeOutStart)/(e.fadeOutEnd-e.fadeOutStart))*r,o("ramping \u25bc volume",{currentTime:i,currentVolume:n,calculatedVolume:r,sound:e})):o("updating volume",{currentTime:i,currentVolume:n,calculatedVolume:r,sound:e}),n!=r&&(a?t.gain.value=r:t.audio.volume=r,t.volume=r)},_debugAudioObject:function(t){for(var e=["abort","load","loadend","loadstart","loadeddata","loadedmetadata","canplay","canplaythrough","seeked","seeking","stalled","timeupdate","volumechange","waiting","durationchange","progress","emptied","ended","play","pause"],i=this,r=0;r<e.length;r++)t.addEventListener(e[r],function(t){var e=t.currentTarget,r=e===i.active.audio?"active":e===i.preparing.audio?"preparing":"fading";o(r+": "+t.type),o("    active: "+n(i.active.audio)),o("    preparing: "+n(i.preparing.audio)),o("    fading: "+n(i.fading.audio)),e.src})},create:function(t,e){var i=r.uniqueId("feed-play-"),n=new l(this,e,i,t);return o("created play "+i+" ("+t+")",e),this.outstandingPlays[n.id]=n,this.active.audio?this._prepare(n.url,n.startPosition):this.prepareWhenReady=n.url,n},prepare:function(t){if(this.active.audio){var e=this.active.audio.buffered;return e.length>0&&e.end(e.length-1)>=this.active.audio.duration?this._prepare(t,0):this.active.audio.url===u?this._prepare(t,0):void(this.prepareWhenReady=t)}this.prepareWhenReady=t},_prepare:function(t,e){this.prepareWhenReady=null,this.preparing.audio.src!==t&&(o("preparing "+t),this.preparing.audio.src=t),e&&this.preparing.audio.currentTime!==e&&(o("advancing preparing audio to",e/1e3),this.preparing.audio.currentTime=e/1e3)},_playSound:function(t){var e=this;if(this.active.audio)if(this.active.sound===t)this.active.audio.paused?(o(t.id+" was paused, so resuming"),this.active.audio.play().then(function(){o("resumed playback"),t.trigger("play")}).catch(function(i){o("error resuming playback"),e.active.sound=null,t.trigger("finish")}),this.fading.sound&&this.fading.audio.play().then(function(){o("resumed fading playback")}).catch(function(t){o("error resuming fading playback"),e.fading.sound=null,e.fading.audio.src=u})):o(t.id+" is already playing");else{this.preparing.audio.src!==t.url&&this._prepare(t.url,t.startPosition);var i=this.active;if(this.active=this.preparing,this.preparing=i,this.active.sound=null,this._setVolume(this.active,t),this.preparing.audio.src=u,this.preparing.sound){var n=this.preparing.sound;this.preparing.sound=null,n.trigger("finish")}o(t.id+" starting"),this.active.audio.play().then(function(){o("success starting playback"),e.active.sound=t,t.fadeOutSeconds&&0===t.fadeOutEnd&&(t.fadeOutStart=e.active.audio.duration-t.fadeOutSeconds,t.fadeOutEnd=e.active.audio.duration),t.startPosition&&(o("updating start position"),e.active.audio.currentTime=t.startPosition/1e3,o("updated"));var i=e.active.audio.paused;t.trigger("play"),i&&t.trigger("pause")}).catch(function(e){o("error starting playback",e),t.trigger("finish",e)})}else console.log("**** player.initializeAudio() *** not called")},_destroySound:function(t){o("want to destroy, and current is",t,this.active.sound),t.off(),this.active.sound===t&&(o("destroy triggered for current sound",t.id),this.active.audio.pause()),delete h.outstandingPlays[this.id]},_pauseSound:function(t){null!=t&&t!==this.active.sound||(this.active.audio.pause(),this.fading.sound&&this.fading.audio.pause())},_position:function(t){return t===this.active.sound?(t.url!==this.active.audio.src&&o("trying to get current song position, but it is not in the active audio player"),Math.floor(1e3*this.active.audio.currentTime)):0},_duration:function(t){if(t===this.active.sound){t.url!==this.active.audio.src&&o("trying to get current song duration, but it is not in the active audio player");var e=this.active.audio.duration;return isNaN(e)?0:Math.floor(1e3*e)}return 0},setVolume:function(t){return void 0!==t&&(this.vol=t,this.active&&this.active.sound&&this._setVolume(this.active),this.trigger("volume",t)),this.vol}},r.extend(c.prototype,s);var h=null;e.exports=function(t,e){return null===h&&(h=new c(t)),e(h.preferred),h}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./events":7,"./nolog":9,"./util":14,"./version":15}],14:[function(t,e,i){var n={};n.addProtocol=function(t,e){return"//"===t.slice(0,2)&&(t=!0===e?"https:"+t:!1===e?"http:"+t:"http"===window.location.protocol.substr(0,4)?window.location.protocol+t:"http"),t},e.exports=n},{}],15:[function(t,e,i){e.exports="1.10.3-native"},{}]},{},[8])(8)});
//# sourceMappingURL=feed.js.map
