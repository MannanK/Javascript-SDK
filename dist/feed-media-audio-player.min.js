var Feed=function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var e=t((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),i=t((function(t){var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)})),n=(i.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),r=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t},o=function(t){try{return!!t()}catch(t){return!0}},s=!o((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),a=e.document,u=n(a)&&n(a.createElement),c=function(t){return u?a.createElement(t):{}},l=!s&&!o((function(){return 7!=Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a})),d=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")},p=Object.defineProperty,h={f:s?Object.defineProperty:function(t,e,i){if(r(t),e=d(e,!0),r(i),l)try{return p(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},f=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},y=s?function(t,e,i){return h.f(t,e,f(1,i))}:function(t,e,i){return t[e]=i,t},g={}.hasOwnProperty,v=function(t,e){return g.call(t,e)},m=0,_=Math.random(),P=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++m+_).toString(36))},b=t((function(t){var n=e["__core-js_shared__"]||(e["__core-js_shared__"]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})})),S=b("native-function-to-string",Function.toString),k=t((function(t){var n=P("src"),r=(""+S).split("toString");i.inspectSource=function(t){return S.call(t)},(t.exports=function(t,i,o,s){var a="function"==typeof o;a&&(v(o,"name")||y(o,"name",i)),t[i]!==o&&(a&&(v(o,n)||y(o,n,t[i]?""+t[i]:r.join(String(i)))),t===e?t[i]=o:s?t[i]?t[i]=o:y(t,i,o):(delete t[i],y(t,i,o)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[n]||S.call(this)}))})),w=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},x=function(t,e,i){if(w(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}},O=function(t,n,r){var o,s,a,u,c=t&O.F,l=t&O.G,d=t&O.S,p=t&O.P,h=t&O.B,f=l?e:d?e[n]||(e[n]={}):(e[n]||{}).prototype,g=l?i:i[n]||(i[n]={}),v=g.prototype||(g.prototype={});for(o in l&&(r=n),r)a=((s=!c&&f&&void 0!==f[o])?f:r)[o],u=h&&s?x(a,e):p&&"function"==typeof a?x(Function.call,a):a,f&&k(f,o,a,t&O.U),g[o]!=a&&y(g,o,u),p&&v[o]!=a&&(v[o]=a)};e.core=i,O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var A,E=O,T={}.toString,I=function(t){return T.call(t).slice(8,-1)},j=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==I(t)?t.split(""):Object(t)},C=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},L=function(t){return j(C(t))},R=Math.ceil,q=Math.floor,M=function(t){return isNaN(t=+t)?0:(t>0?q:R)(t)},N=Math.min,B=function(t){return t>0?N(M(t),9007199254740991):0},D=Math.max,F=Math.min,V=b("keys"),$=function(t){return V[t]||(V[t]=P(t))},U=(A=!1,function(t,e,i){var n,r=L(t),o=B(r.length),s=function(t,e){return(t=M(t))<0?D(t+e,0):F(t,e)}(i,o);if(A&&e!=e){for(;o>s;)if((n=r[s++])!=n)return!0}else for(;o>s;s++)if((A||s in r)&&r[s]===e)return A||s||0;return!A&&-1}),z=$("IE_PROTO"),W=function(t,e){var i,n=L(t),r=0,o=[];for(i in n)i!=z&&v(n,i)&&o.push(i);for(;e.length>r;)v(n,i=e[r++])&&(~U(o,i)||o.push(i));return o},H="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),G=Object.keys||function(t){return W(t,H)},J={f:Object.getOwnPropertySymbols},K={f:{}.propertyIsEnumerable},Y=function(t){return Object(C(t))},X=Object.assign,Z=!X||o((function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach((function(t){e[t]=t})),7!=X({},t)[i]||Object.keys(X({},e)).join("")!=n}))?function(t,e){for(var i=Y(t),n=arguments.length,r=1,o=J.f,a=K.f;n>r;)for(var u,c=j(arguments[r++]),l=o?G(c).concat(o(c)):G(c),d=l.length,p=0;d>p;)u=l[p++],s&&!a.call(c,u)||(i[u]=c[u]);return i}:X;E(E.S+E.F,"Object",{assign:Z});var Q=!1,tt=function t(){var e,i=Array.prototype.slice.call(arguments);i[0]="feed.fm: "+i[0],Q&&console.log.apply(console,i);try{e=JSON.stringify({ts:new Date,message:i[0],args:i.slice(1)})}catch(t){e=JSON.stringify({ts:new Date,message:i[0],args:"truncated"})}t.history.push(e),history.length>500&&t.history.shift()};tt.history=[],tt.enable=function(){Q=!0};var et,it=t((function(t){var i=b("wks"),n=e.Symbol,r="function"==typeof n;(t.exports=function(t){return i[t]||(i[t]=r&&n[t]||(r?n:P)("Symbol."+t))}).store=i})),nt=it("match"),rt=function(t){var e;return n(t)&&(void 0!==(e=t[nt])?!!e:"RegExp"==I(t))},ot=it("species"),st=function(t,e){var i,n=r(t).constructor;return void 0===n||null==(i=r(n)[ot])?e:w(i)},at=(et=!0,function(t,e){var i,n,r=String(C(t)),o=M(e),s=r.length;return o<0||o>=s?et?"":void 0:(i=r.charCodeAt(o))<55296||i>56319||o+1===s||(n=r.charCodeAt(o+1))<56320||n>57343?et?r.charAt(o):i:et?r.slice(o,o+2):n-56320+(i-55296<<10)+65536}),ut=function(t,e,i){return e+(i?at(t,e).length:1)},ct=it("toStringTag"),lt="Arguments"==I(function(){return arguments}()),dt=function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ct))?i:lt?I(e):"Object"==(n=I(e))&&"function"==typeof e.callee?"Arguments":n},pt=RegExp.prototype.exec,ht=function(t,e){var i=t.exec;if("function"==typeof i){var n=i.call(t,e);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==dt(t))throw new TypeError("RegExp#exec called on incompatible receiver");return pt.call(t,e)},ft=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},yt=RegExp.prototype.exec,gt=String.prototype.replace,vt=yt,mt=function(){var t=/a/,e=/b*/g;return yt.call(t,"a"),yt.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),_t=void 0!==/()??/.exec("")[1];(mt||_t)&&(vt=function(t){var e,i,n,r,o=this;return _t&&(i=new RegExp("^"+o.source+"$(?!\\s)",ft.call(o))),mt&&(e=o.lastIndex),n=yt.call(o,t),mt&&n&&(o.lastIndex=o.global?n.index+n[0].length:e),_t&&n&&n.length>1&&gt.call(n[0],i,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(n[r]=void 0)})),n});var Pt=vt;E({target:"RegExp",proto:!0,forced:Pt!==/./.exec},{exec:Pt});var bt=it("species"),St=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),kt=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}(),wt=Math.min,xt=[].push,Ot="length",At=!o((function(){RegExp(4294967295,"y")}));function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function It(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function jt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Lt(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ct(t,e):void 0}}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}!function(t,e,i){var n=it(t),r=!o((function(){var e={};return e[n]=function(){return 7},7!=""[t](e)})),s=r?!o((function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[bt]=function(){return i}),i[n](""),!e})):void 0;if(!r||!s||"replace"===t&&!St||"split"===t&&!kt){var a=/./[n],u=i(C,n,""[t],(function(t,e,i,n,o){return e.exec===Pt?r&&!o?{done:!0,value:a.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}})),c=u[0],l=u[1];k(String.prototype,t,c),y(RegExp.prototype,n,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)})}}("split",2,(function(t,e,i,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[Ot]||2!="ab".split(/(?:ab)*/)[Ot]||4!=".".split(/(.?)(.?)/)[Ot]||".".split(/()()/)[Ot]>1||"".split(/.?/)[Ot]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!rt(t))return i.call(n,t,e);for(var r,o,s,a=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),c=0,l=void 0===e?4294967295:e>>>0,d=new RegExp(t.source,u+"g");(r=Pt.call(d,n))&&!((o=d.lastIndex)>c&&(a.push(n.slice(c,r.index)),r[Ot]>1&&r.index<n[Ot]&&xt.apply(a,r.slice(1)),s=r[0][Ot],c=o,a[Ot]>=l));)d.lastIndex===r.index&&d.lastIndex++;return c===n[Ot]?!s&&d.test("")||a.push(""):a.push(n.slice(c)),a[Ot]>l?a.slice(0,l):a}:"0".split(void 0,0)[Ot]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var r=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,r,n):o.call(String(r),i,n)},function(t,e){var s=n(o,t,this,e,o!==i);if(s.done)return s.value;var a=r(t),u=String(this),c=st(a,RegExp),l=a.unicode,d=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(At?"y":"g"),p=new c(At?a:"^(?:"+a.source+")",d),h=void 0===e?4294967295:e>>>0;if(0===h)return[];if(0===u.length)return null===ht(p,u)?[u]:[];for(var f=0,y=0,g=[];y<u.length;){p.lastIndex=At?y:0;var v,m=ht(p,At?u:u.slice(y));if(null===m||(v=wt(B(p.lastIndex+(At?0:y)),u.length))===f)y=ut(u,y,l);else{if(g.push(u.slice(f,y)),g.length===h)return g;for(var _=1;_<=m.length-1;_++)if(g.push(m[_]),g.length===h)return g;y=f=v}}return g.push(u.slice(f)),g}]}));var Rt=it("unscopables"),qt=Array.prototype;null==qt[Rt]&&y(qt,Rt,{});var Mt=function(t){qt[Rt][t]=!0},Nt=function(t,e){return{value:e,done:!!t}},Bt={},Dt=s?Object.defineProperties:function(t,e){r(t);for(var i,n=G(e),o=n.length,s=0;o>s;)h.f(t,i=n[s++],e[i]);return t},Ft=e.document,Vt=Ft&&Ft.documentElement,$t=$("IE_PROTO"),Ut=function(){},zt=function(){var t,e=c("iframe"),i=H.length;for(e.style.display="none",Vt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),zt=t.F;i--;)delete zt.prototype[H[i]];return zt()},Wt=Object.create||function(t,e){var i;return null!==t?(Ut.prototype=r(t),i=new Ut,Ut.prototype=null,i[$t]=t):i=zt(),void 0===e?i:Dt(i,e)},Ht=h.f,Gt=it("toStringTag"),Jt=function(t,e,i){t&&!v(t=i?t:t.prototype,Gt)&&Ht(t,Gt,{configurable:!0,value:e})},Kt={};y(Kt,it("iterator"),(function(){return this}));var Yt=function(t,e,i){t.prototype=Wt(Kt,{next:f(1,i)}),Jt(t,e+" Iterator")},Xt=$("IE_PROTO"),Zt=Object.prototype,Qt=Object.getPrototypeOf||function(t){return t=Y(t),v(t,Xt)?t[Xt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Zt:null},te=it("iterator"),ee=!([].keys&&"next"in[].keys()),ie=function(){return this},ne=function(t,e,i,n,r,o,s){Yt(i,e,n);var a,u,c,l=function(t){if(!ee&&t in f)return f[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},d=e+" Iterator",p="values"==r,h=!1,f=t.prototype,g=f[te]||f["@@iterator"]||r&&f[r],v=g||l(r),m=r?p?l("entries"):v:void 0,_="Array"==e&&f.entries||g;if(_&&(c=Qt(_.call(new t)))!==Object.prototype&&c.next&&(Jt(c,d,!0),"function"!=typeof c[te]&&y(c,te,ie)),p&&g&&"values"!==g.name&&(h=!0,v=function(){return g.call(this)}),(ee||h||!f[te])&&y(f,te,v),Bt[e]=v,Bt[d]=ie,r)if(a={values:p?v:l("values"),keys:o?v:l("keys"),entries:m},s)for(u in a)u in f||k(f,u,a[u]);else E(E.P+E.F*(ee||h),e,a);return a}(Array,"Array",(function(t,e){this._t=L(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,Nt(1)):Nt(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values");Bt.Arguments=Bt.Array,Mt("keys"),Mt("values"),Mt("entries");for(var re=it("iterator"),oe=it("toStringTag"),se=Bt.Array,ae={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},ue=G(ae),ce=0;ce<ue.length;ce++){var le,de=ue[ce],pe=ae[de],he=e[de],fe=he&&he.prototype;if(fe&&(fe[re]||y(fe,re,se),fe[oe]||y(fe,oe,de),Bt[de]=se,pe))for(le in ne)fe[le]||k(fe,le,ne[le],!0)}var ye={};ye[it("toStringTag")]="z",ye+""!="[object z]"&&k(Object.prototype,"toString",(function(){return"[object "+dt(this)+"]"}),!0);!function(t,e){var n=(i.Object||{})[t]||Object[t],r={};r[t]=e(n),E(E.S+E.F*o((function(){n(1)})),"Object",r)}("keys",(function(){return function(t){return G(Y(t))}}));var ge,ve,me,_e,Pe,be,Se,ke,we,xe=Array.isArray||function(t){return"Array"==I(t)},Oe=it("species"),Ae=(me=1==(ge=5),_e=2==ge,Pe=3==ge,be=4==ge,Se=6==ge,ke=5==ge||Se,we=ve||function(t,e){return new(function(t){var e;return xe(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!xe(e.prototype)||(e=void 0),n(e)&&null===(e=e[Oe])&&(e=void 0)),void 0===e?Array:e}(t))(e)},function(t,e,i){for(var n,r,o=Y(t),s=j(o),a=x(e,i,3),u=B(s.length),c=0,l=me?we(t,u):_e?we(t,0):void 0;u>c;c++)if((ke||c in s)&&(r=a(n=s[c],c,o),ge))if(me)l[c]=r;else if(r)switch(ge){case 3:return!0;case 5:return n;case 6:return c;case 2:l.push(n)}else if(be)return!1;return Se?-1:Pe||be?be:l}),Ee=!0;"find"in[]&&Array(1).find((function(){Ee=!1})),E(E.P+E.F*Ee,"Array",{find:function(t){return Ae(this,t,arguments.length>1?arguments[1]:void 0)}}),Mt("find");var Te=Object.getOwnPropertyDescriptor,Ie={f:s?Te:function(t,e){if(t=L(t),e=d(e,!0),l)try{return Te(t,e)}catch(t){}if(v(t,e))return f(!K.f.call(t,e),t[e])}},je=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},Ce={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=x(Function.call,Ie.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return je(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:je}.set,Le=H.concat("length","prototype"),Re={f:Object.getOwnPropertyNames||function(t){return W(t,Le)}},qe=it("species"),Me=function(t){var i=e[t];s&&i&&!i[qe]&&h.f(i,qe,{configurable:!0,get:function(){return this}})},Ne=h.f,Be=Re.f,De=e.RegExp,Fe=De,Ve=De.prototype,$e=/a/g,Ue=/a/g,ze=new De($e)!==$e;if(s&&(!ze||o((function(){return Ue[it("match")]=!1,De($e)!=$e||De(Ue)==Ue||"/a/i"!=De($e,"i")})))){De=function(t,e){var i,r,o,s,a=this instanceof De,u=rt(t),c=void 0===e;return!a&&u&&t.constructor===De&&c?t:(i=ze?new Fe(u&&!c?t.source:t,e):Fe((u=t instanceof De)?t.source:t,u&&c?ft.call(t):e),r=De,(s=(a?this:Ve).constructor)!==r&&"function"==typeof s&&(o=s.prototype)!==r.prototype&&n(o)&&Ce&&Ce(i,o),i)};for(var We=function(t){t in De||Ne(De,t,{configurable:!0,get:function(){return Fe[t]},set:function(e){Fe[t]=e}})},He=Be(Fe),Ge=0;He.length>Ge;)We(He[Ge++]);Ve.constructor=De,De.prototype=Ve,k(e,"RegExp",De)}Me("RegExp");var Je=0;function Ke(t){return t+ ++Je}var Ye=Array.prototype.indexOf;function Xe(t,e,i,n){"function"==typeof e&&(n=i,i=e,e=!1);var r=i?t.map(i,n):t,o=[],s=[];return r.forEach((function(i,n){var r,a;(e?n&&s[s.length-1]===i:(a=i,null!==(r=s)&&(Ye&&r.indexOf===Ye?-1!=r.indexOf(a):r.some((function(t){return t===a})))))||(s.push(i),o.push(t[n]))})),o}function Ze(t,e){var i=e.map((function(t){return new RegExp(t)}));return Xe(t).filter((function(t){return i.find((function(e){return e.test(t)}))}))}function Qe(t,e,i){(t=t?2*t:200)>e&&(t=e),setTimeout((function(){i(t)}),t)}for(var ti=Array.prototype.slice,ei={on:function(t,e,i){return ni(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,i){if(!ni(this,"once",t,[e,i])||!e)return this;var n,r,o,s=this,a=(n=function(){s.off(t,a),e.apply(this,arguments)},o=!1,function(){return o||(o=!0,r=n.apply(this,arguments),n=null),r});return a._callback=e,this.on(t,a,i)},off:function(t,e,i){var n,r,o,s,a,u,c,l;if(!this._events||!ni(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=0,u=(s=t?[t]:Object.keys(this._events)).length;a<u;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=n=[],e||i)for(c=0,l=o.length;c<l;c++)r=o[c],(e&&e!==r.callback&&e!==r.callback._callback||i&&i!==r.context)&&n.push(r);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=ti.call(arguments,1);if(!ni(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&ri(i,e),n&&ri(n,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var r=!e&&!i;for(var o in"object"===Et(e)&&(i=this),t&&((n={})[t._listenerId]=t),n)n[o].off(e,i,this),r&&delete this._listeners[o];return this}},ii=/\s+/,ni=function(t,e,i,n){if(!i)return!0;if("object"===Et(i)){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(ii.test(i)){for(var o=i.split(ii),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(n));return!1}return!0},ri=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e)}},oi={listenTo:"on",listenToOnce:"once"},si=function(){var t=ui[ai],e=oi[t];ei[t]=function(t,i,n){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=Ke("l"))]=t,"object"===Et(i)&&(n=this),t[e](i,n,this),this}},ai=0,ui=Object.keys(oi);ai<ui.length;ai++)si();var ci=/(iPhone|iPad)/i.test(navigator.userAgent),li=ci&&/OS 13_[43210]/i.test(navigator.userAgent),di=ci?"https://u9e9h7z5.map2.ssl.hwcdn.net/feedfm-audio/250-milliseconds-of-silence.mp3":"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",pi=function(t,e,i,n){var r=Object.assign(this,ei);if(r.id=i,r.url=n,r.speaker=t,r.loaded=!1,e){this.startPosition=+e.startPosition,this.endPosition=+e.endPosition,this.fadeInSeconds=+e.fadeInSeconds,this.fadeInSeconds?(this.fadeInStart=this.startPosition?this.startPosition/1e3:0,this.fadeInEnd=this.fadeInStart+this.fadeInSeconds):(this.fadeInStart=0,this.fadeInEnd=0),this.fadeOutSeconds=+e.fadeOutSeconds,this.fadeOutSeconds&&(this.endPosition?(this.fadeOutStart=this.endPosition/1e3-this.fadeOutSeconds,this.fadeOutEnd=this.endPosition/1e3):(this.fadeOutStart=0,this.fadeOutEnd=0));for(var o=0,s=["play","pause","finish","elapse"];o<s.length;o++){var a=s[o];a in e&&r.on(a,e[a])}this.gain=e.gain||0}else this.gain=0;return r};function hi(t){return" src = "+t.src+", time = "+t.currentTime+", paused = "+t.paused+", duration = "+t.duration+", readyState = "+t.readyState}pi.prototype={play:function(){return tt("sound "+this.id+" play"),this.speaker._playSound(this)},pause:function(){return tt("sound "+this.id+" pause"),this.speaker._pauseSound(this)},resume:function(){return tt("sound "+this.id+" resume"),this.speaker._playSound(this)},position:function(){return this.speaker._position(this)},duration:function(){return this.speaker._duration(this)},destroy:function(){tt("sound "+this.id+" destroy"),this.speaker._destroySound(this)},gainAdjustedVolume:function(t){return this.gain?Math.max(Math.min(t/100*(50*Math.pow(10,this.gain/20)),100),0)/100:t/100}};var fi=function(){};fi.iOSp=ci,fi.brokenWebkit=li,fi.prototype={vol:100,outstandingSounds:{},audioContext:null,active:null,fading:null,preparing:null,prepareWhenReady:null,initializeAudio:function(){null===this.active?(tt("initializing for mobile"),this.audioContext=function(){var t=window.AudioContext||window.webkitAudioContext,e=new t;if(44100!==e.sampleRate){var i=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=i,n.connect(e.destination),n.start(0),n.disconnect(),e.close(),e=new t}return e}(),this.active=this._createAudio(di),this.fading=this._createAudio(di),this.preparing=this._createAudio(this.prepareWhenReady?this.prepareWhenReady:di),this.prepareWhenReady=null):tt("mobile already initialized")},getSupportedFormats:function(){return document.createElement("audio").canPlayType("audio/aac")?"aac,mp3":"mp3"},_createAudioGainNode:function(t){var e=this.audioContext.createMediaElementSource(t),i=this.audioContext.createGain();return i.gain.value=1,e.connect(i),i.connect(this.audioContext.destination),i.gain},_createAudio:function(t){var e=new Audio(t);e.crossOrigin="anonymous",e.loop=!1,e.volume=1,this._addEventListeners(e);var i=null;return ci&&!li&&(i=this._createAudioGainNode(e)),{audio:e,sound:null,gain:i,volume:1}},_addEventListeners:function(t){t.addEventListener("pause",this._onAudioPauseEvent.bind(this)),t.addEventListener("ended",this._onAudioEndedEvent.bind(this)),t.addEventListener("timeupdate",this._onAudioTimeUpdateEvent.bind(this))},_onAudioPauseEvent:function(t){var e=t.currentTarget;e.src!==di&&e===this.active.audio&&e.currentTime!==e.duration&&(this.active.sound&&this.active.sound.url===e.src?this.active.sound.trigger("pause"):tt("active audio pause, but no matching sound"))},_onAudioEndedEvent:function(t){var e=t.currentTarget;if(e.src!==di){if(e===this.fading.audio)return e.src=di,void(this.fading.sound=null);if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){tt("active audio ended");var i=this.active.sound;this.active.sound=null,i.trigger("finish")}else tt("active audio ended, but no matching sound",e.src)}},_onAudioTimeUpdateEvent:function(t){var e=t.currentTarget;if(e.src!==di)if(e===this.fading.audio&&this.fading.sound)this.fading.sound.endPosition&&e.currentTime>=this.fading.sound.endPosition/1e3?(this.fading.sound=null,this.fading.audio.src=di):this._setVolume(this.fading);else if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){if(this.active.sound.endPosition&&this.active.sound.endPosition/1e3<=e.currentTime){var i=this.active.sound;this.active.sound=null,this.active.audio.src=di,i.trigger("finish")}else if(this.active.sound.fadeOutEnd&&e.currentTime>=this.active.sound.fadeOutStart){this._setVolume(this.active);var n=this.fading;this.fading=this.active,this.active=n,this.active.sound=null,this.fading.sound.trigger("finish")}else this._setVolume(this.active),this.active.sound.trigger("elapse");this.prepareWhenReady&&this.prepare(this.prepareWhenReady)}else tt("active audio elapsed, but no matching sound, so ignoring",e.src)},_setVolume:function(t,e){e||(e=t.sound);var i=t.audio.currentTime,n=t.volume,r=e.gainAdjustedVolume(this.vol);e.fadeInStart!==e.fadeInEnd&&i<e.fadeInStart?(r=0,tt("pre-fade-in volume is 0")):e.fadeInStart!==e.fadeInEnd&&i>=e.fadeInStart&&i<=e.fadeInEnd?(r=(i-e.fadeInStart)/(e.fadeInEnd-e.fadeInStart)*r,tt("ramping \u25b2 volume",{currentTime:i,currentVolume:n,calculatedVolume:r,sound:e})):e.fadeOutStart!==e.fadeOutEnd&&i>e.fadeOutEnd?(r=0,tt("post-fade-out volume is 0")):e.fadeOutStart!==e.fadeOutEnd&&i>=e.fadeOutStart&&i<=e.fadeOutEnd&&(r=(1-(i-e.fadeOutStart)/(e.fadeOutEnd-e.fadeOutStart))*r,tt("ramping \u25bc volume",{currentTime:i,currentVolume:n,calculatedVolume:r,sound:e})),n!==r&&(ci?li||(t.gain.value=r):t.audio.volume=r,t.volume=r)},_debugAudioObject:function(t){for(var e=["abort","load","loadend","loadstart","loadeddata","loadedmetadata","canplay","canplaythrough","seeked","seeking","stalled","timeupdate","volumechange","waiting","durationchange","progress","emptied","ended","play","pause"],i=this,n=0;n<e.length;n++)t.addEventListener(e[n],(function(t){var e=t.currentTarget,n=e===i.active.audio?"active":e===i.preparing.audio?"preparing":"fading";tt(n+": "+t.type),tt("    active: "+hi(i.active.audio)),tt("    preparing: "+hi(i.preparing.audio)),tt("    fading: "+hi(i.fading.audio)),e.src}))},create:function(t,e){var i=Ke("feed-play-"),n=new pi(this,e,i,t);return tt("created play "+i+" ("+t+")",e),this.outstandingSounds[n.id]=n,this.active&&this.active.audio?this.preparing.audio.src===di&&(tt("preparing sound now"),this._prepare(n.url,n.startPosition)):(tt("no audio prepared yet, so preparing when ready"),this.prepareWhenReady=n.url),n},prepare:function(t){if(!this.active||!this.active.audio)return tt("saving url to prepare for later",t),void(this.prepareWhenReady=t);var e=this.active.audio.buffered;return e.length>0&&e.end(e.length-1)>=this.active.audio.duration?(tt("active song has loaded enough, to preparing",t),this._prepare(t,0)):this.active.audio.url===di?(tt("preparing over silence"),this._prepare(t,0)):(tt("nothing available to do active prepare"),void(this.prepareWhenReady=t))},logState:function(t){for(var e in console.group("speaker: "+(t||"")),this.active?(console.group("active"),console.log("audio.src: ".concat(this.active.audio.src)),console.log("audio.paused: ".concat(this.active.audio.paused)),console.log("sound: ".concat(this.active.sound?this.active.sound.id:"NULL")),console.log("volume: ".concat(this.active.volume)),console.groupEnd(),console.group("preparing"),console.log("audio.src: ".concat(this.preparing.audio.src)),console.log("audio.paused: ".concat(this.preparing.audio.paused)),console.log("sound: ".concat(this.preparing.sound?this.preparing.sound.id:"NULL")),console.log("volume: ".concat(this.preparing.volume)),console.groupEnd(),console.group("fading"),console.log("audio.src: ".concat(this.fading.audio.src)),console.log("audio.paused: ".concat(this.fading.audio.paused)),console.log("sound: ".concat(this.fading.sound?this.fading.sound.id:"NULL")),console.log("volume: ".concat(this.fading.volume)),console.groupEnd()):(console.group("active"),console.log("uninitialized"),console.groupEnd(),console.group("preparing"),console.log("uninitialized"),console.groupEnd(),console.group("fading"),console.log("uninitialized"),console.groupEnd()),console.group("outstanding sounds"),this.outstandingSounds){var i=this.outstandingSounds[e];console.log(i.id+": "+i.url)}console.groupEnd(),console.groupEnd()},_prepare:function(t,e){this.prepareWhenReady=null,this.preparing.audio.src!==t&&(tt("preparing "+t),this.preparing.audio.src=t),e&&this.preparing.audio.currentTime!==e&&(tt("advancing preparing audio to",e/1e3),this.preparing.audio.currentTime=e/1e3)},_playSound:function(t){var e=this;if(this.active&&this.active.audio)if(this.active.sound===t)this.active.audio.paused?(tt(t.id+" was paused, so resuming"),this.active.audio.play().then((function(){tt("resumed playback"),t.trigger("play")})).catch((function(){tt("error resuming playback"),e.active.sound=null,t.trigger("finish")})),this.fading.sound&&this.fading.audio.play().then((function(){tt("resumed fading playback")})).catch((function(){tt("error resuming fading playback"),e.fading.sound=null,e.fading.audio.src=di}))):tt(t.id+" is already playing");else{this.preparing.audio.src!==t.url&&this._prepare(t.url,t.startPosition);var i=this.active;if(this.active=this.preparing,this.preparing=i,this.active.sound=null,this._setVolume(this.active,t),this.preparing.sound){this.preparing.audio.src=di;var n=this.preparing.sound;this.preparing.sound=null,n.trigger("finish")}tt(t.id+" initiating play()");var r=this.active;this.active.audio.play().then((function(){if(!e.outstandingSounds[t.id])return tt(t.id+" play() succeeded, but sound has been destroyed"),void(r.audio&&r.audio.src===t.url&&(tt(t.id+" being paused and unloaded"),r.audio.pause(),r.audio.src=di));tt(t.id+" play() succeeded"),r.sound=t,t.fadeOutSeconds&&0===t.fadeOutEnd&&(t.fadeOutStart=r.audio.duration-t.fadeOutSeconds,t.fadeOutEnd=r.audio.duration),t.startPosition&&(tt("updating start position"),r.audio.currentTime=t.startPosition/1e3,tt("updated"));var i=r.audio.paused;t.trigger("play"),r.pauseAfterPlay?r.audio.pause():i&&t.trigger("pause")})).catch((function(e){tt("error starting playback with sound "+t.id,e),t.trigger("finish",e)}))}else console.error("**** player.initializeAudio() *** not called before playback!")},_destroySound:function(t){t.off(),this.active&&this.active.sound===t?(tt("destroy triggered for current sound",t.id),this.active.audio.pause()):tt("destroy triggered for inactive sound",t.id),delete this.outstandingSounds[t.id]},flush:function(){for(var t in this.outstandingSounds)this.outstandingSounds[t].destroy()},_pauseSound:function(t){this.active&&t.url===this.active.audio.src&&(this.active.sound===t?this.active.audio.pause():this.active.pauseAfterPlay=!0),this.fading&&this.fading.audio&&this.fading.audio.pause()},_position:function(t){return this.active&&t===this.active.sound?(t.url!==this.active.audio.src&&tt("trying to get current song position, but it is not in the active audio player"),Math.floor(1e3*this.active.audio.currentTime)):0},_duration:function(t){if(t===this.active.sound){t.url!==this.active.audio.src&&tt("trying to get current song duration, but it is not in the active audio player");var e=this.active.audio.duration;return isNaN(e)?0:Math.floor(1e3*e)}return 0},setVolume:function(t){return void 0!==t&&(this.vol=t,this.active&&this.active.sound&&this._setVolume(this.active),this.trigger("volume",t)),this.vol},getVolume:function(){return this.vol}},Object.assign(fi.prototype,ei);var yi,gi,vi,mi=function(t,e,i,n){try{return n?e(r(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}},_i=it("iterator"),Pi=Array.prototype,bi=it("iterator"),Si=i.getIteratorMethod=function(t){if(null!=t)return t[bi]||t["@@iterator"]||Bt[dt(t)]},ki=t((function(t){var e={},i={},n=t.exports=function(t,n,o,s,a){var u,c,l,d,p,h=a?function(){return t}:Si(t),f=x(o,s,n?2:1),y=0;if("function"!=typeof h)throw TypeError(t+" is not iterable!");if(void 0===(p=h)||Bt.Array!==p&&Pi[_i]!==p){for(l=h.call(t);!(c=l.next()).done;)if((d=mi(l,f,c.value,n))===e||d===i)return d}else for(u=B(t.length);u>y;y++)if((d=n?f(r(c=t[y])[0],c[1]):f(t[y]))===e||d===i)return d};n.BREAK=e,n.RETURN=i})),wi=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)},xi=e.process,Oi=e.setImmediate,Ai=e.clearImmediate,Ei=e.MessageChannel,Ti=e.Dispatch,Ii=0,ji={},Ci=function(){var t=+this;if(ji.hasOwnProperty(t)){var e=ji[t];delete ji[t],e()}},Li=function(t){Ci.call(t.data)};Oi&&Ai||(Oi=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return ji[++Ii]=function(){wi("function"==typeof t?t:Function(t),e)},yi(Ii),Ii},Ai=function(t){delete ji[t]},"process"==I(xi)?yi=function(t){xi.nextTick(x(Ci,t,1))}:Ti&&Ti.now?yi=function(t){Ti.now(x(Ci,t,1))}:Ei?(vi=(gi=new Ei).port2,gi.port1.onmessage=Li,yi=x(vi.postMessage,vi,1)):e.addEventListener&&"function"==typeof postMessage&&!e.importScripts?(yi=function(t){e.postMessage(t+"","*")},e.addEventListener("message",Li,!1)):yi="onreadystatechange"in c("script")?function(t){Vt.appendChild(c("script")).onreadystatechange=function(){Vt.removeChild(this),Ci.call(t)}}:function(t){setTimeout(x(Ci,t,1),0)});var Ri={set:Oi,clear:Ai},qi=Ri.set,Mi=e.MutationObserver||e.WebKitMutationObserver,Ni=e.process,Bi=e.Promise,Di="process"==I(Ni);function Fi(t){var e,i;this.promise=new t((function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n})),this.resolve=w(e),this.reject=w(i)}var Vi={f:function(t){return new Fi(t)}},$i=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Ui=e.navigator,zi=Ui&&Ui.userAgent||"",Wi=function(t,e){if(r(t),n(e)&&e.constructor===t)return e;var i=Vi.f(t);return(0,i.resolve)(e),i.promise},Hi=it("iterator"),Gi=!1;try{var Ji=[7][Hi]();Ji.return=function(){Gi=!0},Array.from(Ji,(function(){throw 2}))}catch(t){}var Ki,Yi,Xi,Zi,Qi=Ri.set,tn=function(){var t,i,n,r=function(){var e,r;for(Di&&(e=Ni.domain)&&e.exit();t;){r=t.fn,t=t.next;try{r()}catch(e){throw t?n():i=void 0,e}}i=void 0,e&&e.enter()};if(Di)n=function(){Ni.nextTick(r)};else if(!Mi||e.navigator&&e.navigator.standalone)if(Bi&&Bi.resolve){var o=Bi.resolve(void 0);n=function(){o.then(r)}}else n=function(){qi.call(e,r)};else{var s=!0,a=document.createTextNode("");new Mi(r).observe(a,{characterData:!0}),n=function(){a.data=s=!s}}return function(e){var r={fn:e,next:void 0};i&&(i.next=r),t||(t=r,n()),i=r}}(),en=e.TypeError,nn=e.process,rn=nn&&nn.versions,on=rn&&rn.v8||"",sn=e.Promise,an="process"==dt(nn),un=function(){},cn=Yi=Vi.f,ln=!!function(){try{var t=sn.resolve(1),e=(t.constructor={})[it("species")]=function(t){t(un,un)};return(an||"function"==typeof PromiseRejectionEvent)&&t.then(un)instanceof e&&0!==on.indexOf("6.6")&&-1===zi.indexOf("Chrome/66")}catch(t){}}(),dn=function(t){var e;return!(!n(t)||"function"!=typeof(e=t.then))&&e},pn=function(t,e){if(!t._n){t._n=!0;var i=t._c;tn((function(){for(var n=t._v,r=1==t._s,o=0,s=function(e){var i,o,s,a=r?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{a?(r||(2==t._h&&yn(t),t._h=1),!0===a?i=n:(l&&l.enter(),i=a(n),l&&(l.exit(),s=!0)),i===e.promise?c(en("Promise-chain cycle")):(o=dn(i))?o.call(i,u,c):u(i)):c(n)}catch(t){l&&!s&&l.exit(),c(t)}};i.length>o;)s(i[o++]);t._c=[],t._n=!1,e&&!t._h&&hn(t)}))}},hn=function(t){Qi.call(e,(function(){var i,n,r,o=t._v,s=fn(t);if(s&&(i=$i((function(){an?nn.emit("unhandledRejection",o,t):(n=e.onunhandledrejection)?n({promise:t,reason:o}):(r=e.console)&&r.error&&r.error("Unhandled promise rejection",o)})),t._h=an||fn(t)?2:1),t._a=void 0,s&&i.e)throw i.v}))},fn=function(t){return 1!==t._h&&0===(t._a||t._c).length},yn=function(t){Qi.call(e,(function(){var i;an?nn.emit("rejectionHandled",t):(i=e.onrejectionhandled)&&i({promise:t,reason:t._v})}))},gn=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),pn(e,!0))},vn=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw en("Promise can't be resolved itself");(e=dn(t))?tn((function(){var n={_w:i,_d:!1};try{e.call(t,x(vn,n,1),x(gn,n,1))}catch(t){gn.call(n,t)}})):(i._v=t,i._s=1,pn(i,!1))}catch(t){gn.call({_w:i,_d:!1},t)}}};function mn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _n(t){var e=t.charAt(t.length-1),i=parseInt(t,10),n=new Date;switch(e){case"Y":n.setFullYear(n.getFullYear()+i);break;case"M":n.setMonth(n.getMonth()+i);break;case"D":n.setDate(n.getDate()+i);break;case"h":n.setHours(n.getHours()+i);break;case"m":n.setMinutes(n.getMinutes()+i);break;case"s":n.setSeconds(n.getSeconds()+i);break;default:n=new Date(t)}return n}function Pn(){return(Pn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function bn(t,e){if(void 0===e&&(e=decodeURIComponent),"string"!=typeof t||!t)return null;var i=new RegExp("(?:^|; )"+(t.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")+"(?:=([^;]*))?(?:;|$)")).exec(document.cookie);return null===i?null:"function"==typeof e?e(i[1]):i[1]}function Sn(t,e,i,n){void 0===i&&(i=encodeURIComponent),"object"==typeof i&&null!==i&&(n=i,i=encodeURIComponent);var r=function(t){var e="";for(var i in t)if(mn(t,i))if(/^expires$/i.test(i)){var n=t[i];"object"!=typeof n&&(n=_n(n+="number"==typeof n?"D":"")),e+=";"+i+"="+n.toUTCString()}else/^secure$/.test(i)?t[i]&&(e+=";"+i):e+=";"+i+"="+t[i];return mn(t,"path")||(e+=";path=/"),e}(n||{}),o=t+"="+("function"==typeof i?i(e):e)+r;document.cookie=o}function kn(t,e){var i={expires:-1};return e&&(i=Pn({},e,i)),Sn(t,"a",i)}ln||(sn=function(t){!function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!")}(this,sn,"Promise","_h"),w(t),Ki.call(this);try{t(x(vn,this,1),x(gn,this,1))}catch(t){gn.call(this,t)}},(Ki=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,i){for(var n in e)k(t,n,e[n],i);return t}(sn.prototype,{then:function(t,e){var i=cn(st(this,sn));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=an?nn.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&pn(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),Xi=function(){var t=new Ki;this.promise=t,this.resolve=x(vn,t,1),this.reject=x(gn,t,1)},Vi.f=cn=function(t){return t===sn||t===Zi?new Xi(t):Yi(t)}),E(E.G+E.W+E.F*!ln,{Promise:sn}),Jt(sn,"Promise"),Me("Promise"),Zi=i.Promise,E(E.S+E.F*!ln,"Promise",{reject:function(t){var e=cn(this);return(0,e.reject)(t),e.promise}}),E(E.S+E.F*!ln,"Promise",{resolve:function(t){return Wi(this,t)}}),E(E.S+E.F*!(ln&&function(t,e){if(!e&&!Gi)return!1;var i=!1;try{var n=[7],r=n[Hi]();r.next=function(){return{done:i=!0}},n[Hi]=function(){return r},t(n)}catch(t){}return i}((function(t){sn.all(t).catch(un)}))),"Promise",{all:function(t){var e=this,i=cn(e),n=i.resolve,r=i.reject,o=$i((function(){var i=[],o=0,s=1;ki(t,!1,(function(t){var a=o++,u=!1;i.push(void 0),s++,e.resolve(t).then((function(t){u||(u=!0,i[a]=t,--s||n(i))}),r)})),--s||n(i)}));return o.e&&r(o.v),i.promise},race:function(t){var e=this,i=cn(e),n=i.reject,r=$i((function(){ki(t,!1,(function(t){e.resolve(t).then(i.resolve,n)}))}));return r.e&&n(r.v),i.promise}}),E(E.P+E.R,"Promise",{finally:function(t){var n=st(this,i.Promise||e.Promise),r="function"==typeof t;return this.then(r?function(e){return Wi(n,t()).then((function(){return e}))}:t,r?function(e){return Wi(n,t()).then((function(){throw e}))}:t)}});var wn="https://feed.fm";function xn(){return wn}function On(t){wn=function(t,e){return"//"===t.slice(0,2)&&(t=!0===e?"https:"+t:!1===e?"http:"+t:"http"===window.location.protocol.substr(0,4)?window.location.protocol+t:"http"),t}(t)}var An;function En(t,e){var i=bn("cid");if(i)return t(i);fetch(xn()+"/api/v2/client",{method:"POST"}).then((function(t){return t.json()})).then((function(i){i.success?t(i.client_id):Qe(e,2e3,(function(e){En(t,e)}))})).catch((function(i){if(403===i.status)try{var n=JSON.parse(i.responseText);tt("error trying to get client id:",n)}catch(t){tt("unknown response for client id request",t.message)}else tt("unknown client id response status",i.status);Qe(e,2e3,(function(e){En(t,e)}))}))}function Tn(){return An||(An=new Promise((function(t){En((function(e){Sn("cid",e,{expires:3650,path:"/"}),t(e)}))}))),An}var In=function(t,e,i){(i=i||{}).baseUrl&&On(i.baseUrl),this.config={formats:"mp3,aac",maxBitrate:128,timeOffset:0,current:null,pendingRequest:null,pendingPlay:null},Object.assign(this,ei),t&&e&&this.setCredentials(t,e)};In.prototype.setCredentials=function(t,e){this.config.token=t,this.config.secret=e},In.prototype.setPlacementId=function(t){this.config.placementId=t,this.trigger("placement-changed",t),this._retune()},In.prototype.setStationId=function(t){""+this.config.stationId!=""+t&&(this.config.stationId=t,this.trigger("station-changed",t),this._retune())},In.prototype.setFormats=function(t){this.config.formats=t,this._retune()},In.prototype.setMaxBitrate=function(t){this.config.maxBitrate=t},In.prototype.tune=function(){if(!this.config.token)throw new Error("no token set with setCredentials()");if(!this.config.secret)throw new Error("no secret set with setCredentials()");this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0),this._getDefaultPlacementInformation()},In.prototype._getDefaultPlacementInformation=function(t){var e=this;this.config.placementId&&this.config.placement&&this.config.placement.id===this.config.placementId?this._requestNextPlay():Tn().then((function(i){tt("requesting default placement information from server"),e._signedAjax(xn()+"/api/v2/placement?client_id="+i).then((function(t){return t.json()})).then(e._receiveDefaultPlacementInformation.bind(e)).catch(e._failedDefaultPlacementInformation.bind(e,t))}))},In.prototype._receiveDefaultPlacementInformation=function(t){t&&t.success&&t.placement&&(this.config.placement=t.placement,this.config.stations=t.stations,this.config.placementId=t.placement.id,this.trigger("placement-changed",this.config.placementId),this.trigger("placement",t.placement),!("stationId"in this.config)&&t.stations.length>0&&(this.config.stationId=t.stations[0].id,this.trigger("station-changed",this.config.stationId)),this.trigger("stations",t.stations),this._requestNextPlay())},In.prototype._failedDefaultPlacementInformation=function(t,e){var i=this;if(401===e.status)try{var n=JSON.parse(e.responseText);if(n.error&&5===n.error.code)return void this.trigger("invalid-credentials")}catch(t){}else console.warn("error from placement request",e);t=t?2*t:500,setTimeout((function(){i._getDefaultPlacementInformation(t)}),t)},In.prototype.getActivePlacement=function(){return this.config.placement?this.config.placement:null},In.prototype.getActivePlay=function(){return this.config.current?this.config.current.play:null},In.prototype.isTuned=function(){return this.config.current||this.config.pendingRequest},In.prototype.hasActivePlayStarted=function(){return this.config.current&&this.config.current.started},In.prototype._retune=function(){this.isTuned()&&this.tune()},In.prototype.reportPlayStarted=function(){if(!this.config.current)throw new Error("attempt to report a play started, but there is no active play");this._startPlay(this.config.current.play)},In.prototype.reportPlayElapsed=function(t){if(!this.config.current)throw new Error("attempt to report elapsed play time, but the play hasn't started");this._signedAjax(xn()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:t}),headers:{"Content-Type":"application/json"}})},In.prototype.reportPlayCompleted=function(){if(!this.config.current||!this.config.current.started)throw tt("finish on non-active or playing song"),new Error("no active or playing song");this._signedAjax(xn()+"/api/v2/play/"+this.config.current.play.id+"/complete",{method:"POST"}).finally(this._receivePlayCompleted.bind(this))},In.prototype._receivePlayCompleted=function(){if(this.config.pendingRequest)tt("song finished, but we're still waiting for next one to return"),this._assignCurrentPlay(null,!0);else{tt("song finished, and no outstanding request, so playing pendingPlay");var t=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(t)}},In.prototype.reportPlayStopped=function(t){this.config.current&&this.config.current.started&&this._signedAjax(xn()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:t}),headers:{"Content-Type":"application/json"}}),this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0)},In.prototype.requestSkip=function(){var t=this;if(!this.config.current)throw new Error("No song being played");if(!this.config.current.started)throw new Error("No song has been started");this.config.current.canSkip?this._signedAjax(xn()+"/api/v2/play/"+this.config.current.play.id+"/skip",{method:"POST"}).then((function(t){return t.json()})).then(this._receiveSkip.bind(this,this.config.current.play)).catch(this._failSkip.bind(this,this.config.current.play)):setTimeout((function(){t.trigger("skip-denied")}),1)},In.prototype.requestInvalidate=function(){if(!this.config.current)throw new Error("No active song to invalidate!");this._sendInvalidate(this.config.current.play)},In.prototype._sendInvalidate=function(t,e){this._signedAjax(xn()+"/api/v2/play/"+t.id+"/invalidate",{method:"POST"}).then((function(t){return t.json()})).then(this._receiveInvalidate.bind(this,t)).catch(this._failInvalidate.bind(this,e,t))},In.prototype._failInvalidate=function(t,e,i){var n=this;(t=t?2*t:200)<3e3?setTimeout((function(){n._sendInvalidate(e)}),t):tt("gave up trying to invalidate play",i)},In.prototype._receiveInvalidate=function(t,e){if(tt("invalidate response"),this.config.current&&this.config.current.play===t)if(e.success)if(this.config.pendingPlay){tt("invalidating to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else tt("invalidating current song"),this._assignCurrentPlay(null,!0),this.config.pendingRequest||(tt("queueing up new song"),this._requestNextPlay());else tt("failed invalidate! - technically this is impossible")},In.prototype._failSkip=function(t){this.config.current&&this.config.current.play===t&&this.trigger("skip-denied")},In.prototype._receiveSkip=function(t,e){if(this.config.current&&this.config.current.play===t){if(!e.success)return tt("failed skip!"),void this.trigger("skip-denied");if(this.config.pendingPlay){tt("skipping to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else this.config.pendingRequest?(tt("skipping to what is queued up"),this._assignCurrentPlay(null,!0)):(tt("skipping to what is queued up"),this._assignCurrentPlay(null))}},In.prototype._startPlay=function(t){this.config.current.retryCount>2?this._receiveStartPlay(t,{success:!0,can_skip:!0}):(tt("telling server we're starting the play",t),this._signedAjax(xn()+"/api/v2/play/"+t.id+"/start",{method:"POST"}).then((function(t){return t.json()})).then(this._receiveStartPlay.bind(this,t)).catch(this._failStartPlay.bind(this,t)))},In.prototype._receiveStartPlay=function(t,e){e.success?this.config.current&&this.config.current.play===t?(this.config.current.canSkip=e.can_skip,this.config.current.started=!0,this._requestNextPlay(),this.trigger("play-started",t)):tt("received start play, but not waiting any more"):tt("received failed start success")},In.prototype._failStartPlay=function(t,e){var i=this;if(tt("start failed",e),this.config.current&&this.config.current.play===t){if(403===e.status)try{var n=JSON.parse(e.responseText);if(n.error&&20===n.error.code)return this._receiveStartPlay(t,{success:!0,can_skip:!0})}catch(t){tt("unable to parse start play response",t.message)}tt("request failed - trying again in 1 second",e),this.config.current.retryCount++,setTimeout((function(){i._startPlay(t)}))}else tt("startPlay failed, but we don't care any more")},In.prototype._assignCurrentPlay=function(t,e){if(this.config.current){var i=this.config.current.play;this.config.current=null,this.trigger("play-completed",i)}null===t?e?tt("nothing to play... waiting"):(tt("nothing to play from the current station"),this.trigger("plays-exhausted")):(this.config.current={play:t,canSkip:!1,started:!1,retryCount:0},tt("activated new song"),this.trigger("play-active",t))},In.prototype._requestNextPlay=function(t){var e=this;Tn().then((function(i){if(e.config.pendingRequest){if(t){if(t>6e4)return tt("giving up on retrieving next play"),e.config.pendingRequest=null,void(null===e.config.current&&e._assignCurrentPlay(null));tt("retrying pending request"),e.config.pendingRequest.retryCount++;var n=e.config.pendingRequest.ajax;return void e._signedAjax(e.config.pendingRequest.url,n).then((function(t){return t.json()})).then(e._receiveNextPlay.bind(e,n)).catch(e._failedNextPlay.bind(e,t,n))}tt("already waiting for a request to finish")}else{var r={formats:e.config.formats,client_id:i,max_bitrate:e.config.maxBitrate,secure:!0};e.config.placementId&&(r.placement_id=e.config.placementId),e.config.stationId&&(r.station_id=e.config.stationId);var o={method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}};e.config.pendingRequest={url:xn()+"/api/v2/play",ajax:o,retryCount:0},tt("requesting new play from server",o),e._signedAjax(xn()+"/api/v2/play",o).then((function(t){return t.json()})).then(e._receiveNextPlay.bind(e,o)).catch(e._failedNextPlay.bind(e,t,o))}}))},In.prototype._receiveNextPlay=function(t,e){this.config.pendingRequest&&this.config.pendingRequest.ajax===t?(this.config.pendingRequest=null,e.success?(this.trigger("prepare-sound",e.play.audio_file.url),this.config.current?(tt("received play, but we're already playing, so queueing up",e.play),this.config.pendingPlay=e.play):(tt("received play and no current song, making active now",e.play),this._assignCurrentPlay(e.play))):e.error&&9===e.error.code?this.config.current?(tt("ran out of music to play, but we're already playing"),this.config.pendingPlay=null):(tt("ran out of music, and nothing playing now"),this.trigger("plays-exhausted")):tt("unsuccessful response",e)):tt("nextPlay succeeded, but we don't care")},In.prototype._failedNextPlay=function(t,e,i){var n=this;if(tt("next play failed",i),this.config.pendingRequest&&this.config.pendingRequest.ajax===e){if(403===i.status)try{var r=JSON.parse(i.responseText);if(r.error&&19===r.error.code)return this.trigger("music-unavailable",r.error.message),void this.trigger("not-in-us",r.error.message)}catch(t){tt("problem parsing 403 response",t.message)}t=Math.min(t?2*t:500,2e3),tt("request failed - trying again after "+t+"ms"),setTimeout((function(){n._requestNextPlay(t)}),t)}else tt("nextPlay failed, but we don't care")},In.prototype.maybeCanSkip=function(){return this.config.current&&this.config.current.started&&this.config.current.canSkip},In.prototype.likePlay=function(t){this._signedAjax(xn()+"/api/v2/play/"+t+"/like",{method:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!0)},In.prototype.unlikePlay=function(t){this._signedAjax(xn()+"/api/v2/play/"+t+"/like",{method:"DELETE"}),this.config.current&&this.config.current.play.id===t&&delete this.config.current.play.liked},In.prototype.dislikePlay=function(t){this._signedAjax(xn()+"/api/v2/play/"+t+"/dislike",{method:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!1)},In.prototype.suspend=function(t){var e={};return this.config.placementId&&(e.placementId=this.config.placementId),this.config.stationId&&(e.stationId=this.config.stationId),this.config.current&&this.config.current.started&&(e.placement=this.config.placement,e.stations=this.config.stations,e.play=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(i),!0).forEach((function(e){It(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):jt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},this.config.current.play),e.play.startPosition=t,e.canSkip=this.config.current.canSkip),e},In.prototype.unsuspend=function(t){if(this.getActivePlay())throw new Error("You cannot unsuspend after running tune()");return"placementId"in t&&(this.config.placementId=t.placementId,this.trigger("placement-changed",this.config.placementId)),"stationId"in t&&(this.config.stationId=t.stationId,this.trigger("station-changed",this.config.stationId)),"play"in t?(this.config.placement=t.placement,this.config.stations=t.stations,this.trigger("placement",this.config.placement),this.trigger("stations",this.config.stations),this._assignCurrentPlay(t.play),this._receiveStartPlay(t.play,{success:!0,can_skip:t.canSkip}),t.play):(this.tune(),null)};In.prototype._getStoredCid=function(){return bn("cid")},In.prototype._setStoredCid=function(t){Sn("cid",t,{expires:3650,path:"/"})},In.prototype._deleteStoredCid=function(){kn("cid")},In.prototype._sign=function(t){var e;if(t||(t={}),e="Basic "+btoa(this.config.token+":"+this.config.secret),t.headers?t.headers.Authorization=e:t.headers={Authorization:e},t.headers["X-Feed-SDK"]="1.99.20 js",this.extraHeaders)for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&(t.headers[i]=this.extraHeaders[i]);return t},In.prototype._signedAjax=function(t,e){return this._ajax(t,this._sign(e))},In.prototype._ajax=function(t,e){return fetch(t,e)},In.prototype._submitLogHistory=function(){var t=tt.history;return tt.history=[],this._signedAjax(xn()+"/api/v2/session/event",{method:"POST",body:JSON.stringify({event:"playerHistory",parameters:t}),headers:{"Content-Type":"application/json"}})};var jn=h.f,Cn=Function.prototype,Ln=/^\s*function ([^ (]*)/;function Rn(){try{return"localStorage"in window&&null!==window.localStorage&&(window.localStorage["feed-test"]=!0)}catch(t){return!1}}"name"in Cn||s&&jn(Cn,"name",{configurable:!0,get:function(){try{return(""+this).match(Ln)[1]}catch(t){return""}}});var qn=function(t,e,i){var n=this;i=i||{},this.state={paused:!0,simulcast:i.simulcast},i.debug&&tt.enable(),this.trimming=i.trimming||!1,this.normalizeVolume=i.normalizeVolume||!0,this.secondsOfCrossfade=i.secondsOfCrossfade||0,this.crossfadeIn=i.crossfadeIn||!1,Object.assign(this,ei);var r=this.session=new In(t,e,i);this.session.on("play-active",this._onPlayActive,this),this.session.on("play-started",this._onPlayStarted,this),this.session.on("play-completed",this._onPlayCompleted,this),this.session.on("plays-exhausted",this._onPlaysExhausted,this),this.session.on("prepare-sound",this._onPrepareSound,this);for(var o=this,s=function(){var t=u[a];n.session.on(t,(function(){o.trigger.apply(o,[t].concat(Array.prototype.slice.call(arguments,0)))}))},a=0,u=["music-unavailable","not-in-us","invalid-credentials","placement","stations","placement-changed","station-changed","skip-denied"];a<u.length;a++)s();i.debug&&this.session.on("play-active",(function(){o.trigger.apply(o,["play-active"].concat(Array.prototype.slice.call(arguments,0)))}));var c=this.speaker=new fi;if(i.brokenWebkitFormats&&fi.brokenWebkit){var l=i.brokenWebkitFormats.split(","),d=c.getSupportedFormats().split(","),p=Ze(l,d),h=p.join(",");tt("input format list is",l,d),tt("final support list is",h),0===p.length&&(h=c.getSupportedFormats()),r.setFormats(h)}else if(i.formats){var f=i.formats.split(","),y=c.getSupportedFormats().split(","),g=Ze(f,y),v=g.join(",");0===g.length&&(v=c.getSupportedFormats()),tt("input format list is",f,y),tt("final support list is",v),r.setFormats(v)}else r.setFormats(c.getSupportedFormats());this.setMuted(this.isMuted())};qn.prototype.initializeAudio=function(){tt("INTIALIZE AUDIO"),this.speaker.initializeAudio()},qn.prototype.setPlacementId=function(t){tt("SET PLACEMENT ID",t),this.session.setPlacementId(t)},qn.prototype.setStationId=function(t){tt("SET STATION ID",t),this.session.setStationId(t)},qn.prototype.setBaseUrl=function(t){this.session.setBaseUrl(t)},qn.prototype._onPlayActive=function(t){var e={play:this._onSoundPlay.bind(this,t.id),pause:this._onSoundPause.bind(this,t.id),finish:this._onSoundFinish.bind(this,t.id),elapse:this._onSoundElapse.bind(this,t.id)};this.normalizeVolume&&(e.gain=(t.audio_file.replaygain_track_gain||0)+(t.station.pre_gain||0)),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_start&&(e.startPosition=1e3*t.audio_file.extra.trim_start),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_end&&t.audio_file.duration_in_seconds&&(e.endPosition=1e3*(t.audio_file.duration_in_seconds-t.audio_file.extra.trim_end)),this.secondsOfCrossfade&&(this.crossfadeIn&&(e.fadeInSeconds=this.secondsOfCrossfade),e.fadeOutSeconds=this.secondsOfCrossfade);var i=this.speaker.create(t.audio_file.url,e);(this.state.activePlay={id:t.id,sound:i,startReportedToServer:!1,soundCompleted:!1,playStarted:!1,previousPosition:0},this.state.paused)||this.state.activePlay.sound.play()},qn.prototype._onSoundPlay=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){if(this.state.paused=!1,this.state.activePlay.playStarted=!0,!this.state.activePlay.startReportedToServer)return this.session.reportPlayStarted();this.trigger("play-resumed",this.session.getActivePlay())}else tt("received sound play, but active play does not match",this.state.activePlay,t)},qn.prototype.getActivePlay=function(){return this.session.getActivePlay()},qn.prototype.hasActivePlayStarted=function(){return this.session.hasActivePlayStarted()},qn.prototype.getActivePlacement=function(){return this.session.getActivePlacement()},qn.prototype._onSoundPause=function(t){this.state.activePlay&&this.state.activePlay.id===t?(this.state.paused=!0,this.trigger("play-paused",this.session.getActivePlay())):tt("received sound pause, but active play does not match",this.state.activePlay,t)},qn.prototype._onSoundFinish=function(t,e){if(this.state.activePlay&&this.state.activePlay.id===t){if(this.state.activePlay.soundCompleted=!0,e&&(this.state.activePlay.soundCompletedWithError=!0,"NotAllowedError"===e.name))return console.error('Feed.fm: first call to "initializeAudio()" or "play()" must be made in user-initiated event handler'),void this.stop();this.state.activePlay.playStarted?this.state.activePlay.startReportedToServer&&(e?(tt("song completed with error - marking as invalid"),this.session.requestInvalidate()):this.session.reportPlayCompleted()):this.session.requestInvalidate()}else tt("received sound finish, but active play does not match",this.state.activePlay,t)},qn.prototype._onSoundElapse=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){var e=this.state.activePlay.sound.position(),i=Math.floor(this.state.activePlay.previousPosition/3e4),n=Math.floor(e/3e4);this.state.activePlay.previousPosition=e,n!==i&&this.session.reportPlayElapsed(Math.floor(e/1e3))}else tt("received sound elapse, but active play does not match",this.state.activePlay,t)},qn.prototype._onPlayStarted=function(t){var e=this.session;this.state.activePlay&&this.state.activePlay.id===t.id?(this.state.activePlay.startReportedToServer=!0,this.state.activePlay.soundCompleted&&(tt("sound completed before we finished reporting start",this.state.activePlay),this.state.activePlay.soundCompletedWithError?setTimeout((function(){return e.requestInvalidate()}),1):setTimeout((function(){return e.reportPlayCompleted()}),1)),this.updateSimulcast(),this.trigger("play-started",t)):tt("received play started, but it does not match active play",t,this.state.activePlay)},qn.prototype._onPlayCompleted=function(t){if(this.state.activePlay&&this.state.activePlay.id===t.id){this.state.activePlay.sound.destroy();var e=this.state.activePlay.playStarted;delete this.state.activePlay,e&&this.trigger("play-completed",t)}else tt("received play completed, but it does not match active play",t,this.state.activePlay)},qn.prototype._onPlaysExhausted=function(){this.state.paused=!1,this.updateSimulcast(),this.trigger("plays-exhausted")},qn.prototype._onPrepareSound=function(t){tt("preparing",t),this.speaker.prepare(t)},qn.prototype.isPaused=function(){return this.session.isTuned()&&this.state.paused},qn.prototype.getStationInformation=function(t){return this.session.getStationInformation(t)},qn.prototype.tune=function(){tt("TUNE"),this.session.isTuned()||this.session.tune()},qn.prototype.play=function(){tt("PLAY");var t=this.session,e=this.state;if(this.speaker.initializeAudio(),!t.isTuned())return e.paused=!1,t.tune();t.getActivePlay()&&e.activePlay&&e.paused&&(e.activePlay.playStarted?e.activePlay.sound.resume():e.activePlay.sound.play()),e.paused=!1,this.updateSimulcast()},qn.prototype.pause=function(){tt("PAUSE"),this.session.hasActivePlayStarted()&&this.state.activePlay&&!this.state.paused&&(this.state.activePlay.sound.pause(),this.state.paused=!0,this.updateSimulcast())},qn.prototype.like=function(){tt("LIKE"),this.session.hasActivePlayStarted()&&(this.session.likePlay(this.state.activePlay.id),this.trigger("play-liked"))},qn.prototype.unlike=function(){tt("UNLIKE"),this.session.hasActivePlayStarted()&&(this.session.unlikePlay(this.state.activePlay.id),this.trigger("play-unliked"))},qn.prototype.dislike=function(){tt("DISLIKE"),this.session.hasActivePlayStarted()&&(this.session.dislikePlay(this.state.activePlay.id),this.trigger("play-disliked"),this.state.paused=!1,this.skip())},qn.prototype.skip=function(){tt("SKIP"),this.session.hasActivePlayStarted()&&(this.state.paused=!1,this.session.requestSkip())},qn.prototype.stop=function(){tt("STOP"),this.state.paused=!0;var t=this.state.activePlay;if(t&&t.sound){if(tt("stopping active play",t),t.startReportedToServer){var e=t.sound.position();this.session.reportPlayStopped(Math.floor(e/1e3))}t.sound.pause(),t.sound.destroy()}else tt("no active play");delete this.state.activePlay,this.speaker.flush(),this.trigger("play-stopped"),this.updateSimulcast()},qn.prototype.destroy=function(){this.session=null,this.state.activePlay&&this.state.activePlay.sound&&this.state.activePlay.sound.destroy()},qn.prototype.getCurrentState=function(){return this.state.suspended?"suspended":this.session.hasActivePlayStarted()?this.state.paused?"paused":"playing":"idle"},qn.prototype.getPosition=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.position():0},qn.prototype.getDuration=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.duration():0},qn.prototype.maybeCanSkip=function(){return!!this.session.maybeCanSkip()};qn.prototype.isMuted=function(){return!(!Rn()||!("muted"in localStorage))&&"true"===localStorage.muted},qn.prototype.setMuted=function(t){t?(this.speaker.setVolume(0),Rn()&&(localStorage.muted=!0),this.trigger("muted")):(this.speaker.setVolume(100),Rn()&&(localStorage.muted=!1),this.trigger("unmuted"))},qn.prototype.getVolume=function(){return this.speaker.getVolume()},qn.prototype.setVolume=function(t){this.speaker.setVolume(t)},qn.prototype.updateSimulcast=function(){var t=this;if(this.state.simulcast){var e=this.getCurrentState();"suspended"===e&&(e="idle"),Tn().then((function(i){t.session._signedAjax(xn()+"/api/v2/simulcast/".concat(t.state.simulcast,"/in-progress"),{method:"POST",body:JSON.stringify({state:e,client_id:i}),headers:{"Content-Type":"application/json"}})}))}};var Mn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,ei),this._uuid=e,this._state="idle"}var e,i,n;return e=t,(i=[{key:"listen",value:function(){var t=this;this._timeout&&(clearTimeout(this._timeout),delete this._timeout),Tn().then((function(e){t.onTimeout(e)}))}},{key:"stop",value:function(){this._timeout&&(clearTimeout(this._timeout),delete this._timeout);var t=this._state;if(this._state="idle",delete this._activePlay,"idle"!==t)try{this.trigger("state-changed",this._state,t)}catch(t){}}},{key:"onTimeout",value:function(t){var e=this;fetch(xn()+"/api/v2/simulcast/".concat(this._uuid,"/listen"),{method:"POST",body:JSON.stringify({client_id:t}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(i){var n=5e3;if(i.success){var r="idle"===i.state&&"idle"!==e._state,o=e._activePlay,s=e._state,a=e._state=i.state;if("idle"===a?delete e._activePlay:e._activePlay=i.play,s!==a)try{e.trigger("state-changed",a,s)}catch(t){}if("idle"===a){if(r)try{e.trigger("music-stopped")}catch(t){}}else{if(!o||o.id!==e._activePlay.id)try{e.trigger("play-started",e._activePlay)}catch(t){}i.seconds_since_start>20&&i.play.duration_in_seconds-i.seconds_since_start>20&&(n=15e3)}}else if(i.error&&19===i.error.code)return e._state="music-unavailable",void e.trigger("music-unavailable");e._timeout=setTimeout((function(){e.onTimeout(t)}),n)})).catch((function(i){if(403===i.status)try{var n=JSON.parse(i.responseText);if(n.error&&19===n.error.code){try{e._state="music-unavailable",e.trigger("music-unavailable")}catch(t){}return}console.log("unexpected error:",n)}catch(t){console.log("bad response",t.message)}else console.log("odd response",i);e._timeout=setTimeout((function(){e.onTimeout(t)}),15e3)}))}},{key:"getCurrentState",value:function(){return this._state}},{key:"getCurrentPlay",value:function(){return this._activePlay}}])&&Tt(e.prototype,i),n&&Tt(e,n),t}();window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var i=0;i<this.length;i++)t.call(e,this[i],i,this)});var Nn=function(t,e){var i=this;this.alertId=null,this.durationId=null,this.startedPlayback=!1,this.$el=t instanceof Element?t:document.getElementById(t),this.player=e,this.player.on("placement",this._onPlacement,this),this.player.on("play-started",this._onPlayStarted,this),this.player.on("play-paused",this._onPlayPaused,this),this.player.on("play-resumed",this._onPlayResumed,this),this.player.on("play-completed",this._onPlayCompleted,this),this.player.on("play-stopped",this._onPlayStopped,this),this.player.on("play-liked",this._onPlayLiked,this),this.player.on("play-unliked",this._onPlayUnliked,this),this.player.on("play-disliked",this._onPlayDisliked,this),this.player.on("plays-exhausted",this._onPlaysExhausted,this),this.player.on("skip-denied",this._onSkipDenied,this),this.player.on("suspend",this._onSuspend,this),this._enableButtonsBasedOnState(),this.displayText=this.originalDisplayText=this.$el.querySelector(".status").innerHTML,this.renderStatus(),this.$el.querySelectorAll(".status").forEach((function(t){t.addEventListener("click",i._onStatusClick.bind(i))})),this.$el.querySelectorAll(".play-button, .start-button, .resume-button").forEach((function(t){t.addEventListener("click",i._onPlayButtonClick.bind(i))})),this.$el.querySelectorAll(".pause-button").forEach((function(t){t.addEventListener("click",i._onPauseButtonClick.bind(i))})),this.$el.querySelectorAll(".skip-button").forEach((function(t){t.addEventListener("click",i._onSkipButtonClick.bind(i))})),this.$el.querySelectorAll(".like-button").forEach((function(t){t.addEventListener("click",i._onLikeButtonClick.bind(i))})),this.$el.querySelectorAll(".dislike-button").forEach((function(t){t.addEventListener("click",i._onDislikeButtonClick.bind(i))}))};function Bn(t){var e=Math.floor(t/1e3),i=e%60;return i<10&&(i="0"+i),Math.floor(e/60)+":"+i}return Nn.prototype._onStatusClick=function(){"playing"===this.player.getCurrentState()?this._onPauseButtonClick():this._onPlayButtonClick()},Nn.prototype._onPlayButtonClick=function(){this.player.initializeAudio(),this.player.play()},Nn.prototype._onPauseButtonClick=function(){this.player.pause()},Nn.prototype._onSkipButtonClick=function(){this.player.skip()},Nn.prototype._onLikeButtonClick=function(t){tt("like button clicked!",t.target,this),t.target.classList.contains("liked")?this.player.unlike():this.player.like()},Nn.prototype._onDislikeButtonClick=function(){this.player.dislike()},Nn.prototype.$=function(t){return this.$el.find(t)},Nn.prototype._onPlacement=function(t){this.originalDisplayText||(this.originalDisplayText=this.formatPlacement(t),this.renderStatus(this.originalDisplayText))},Nn.prototype.formatPlacement=function(t){return"Tune in to <em class='placement'>"+t.name+"</em>"},Nn.prototype._onPlayStarted=function(t){this.startedPlayback=!0,this.renderStatus(this.formatPlay(t)),this._enableButtonsBasedOnState(),this._setLikeStatus(t.liked),this._enablePositionTracker()},Nn.prototype._enablePositionTracker=function(){var t=this;this.durationId||(this.durationId=window.setInterval((function(){t.renderPosition(t.player.getPosition(),t.player.getDuration())}),500))},Nn.prototype._setLikeStatus=function(t){var e=this.$el.querySelectorAll(".like-button"),i=this.$el.querySelectorAll(".dislike-button");!0===t?(e.forEach((function(t){t.classList.add("liked")})),i.forEach((function(t){t.classList.remove("disliked")}))):!1===t?(e.forEach((function(t){t.classList.remove("liked")})),i.forEach((function(t){t.classList.add("disliked")}))):(e.forEach((function(t){t.classList.remove("liked")})),i.forEach((function(t){t.classList.remove("disliked")})))},Nn.prototype._disablePositionTracker=function(){this.durationId&&(window.clearInterval(this.durationId),this.durationId=null)},Nn.prototype._onPlayResumed=function(){this._enablePositionTracker(),this._enableButtonsBasedOnState()},Nn.prototype._onPlayPaused=function(){this._disablePositionTracker(),this._enableButtonsBasedOnState()},Nn.prototype._onPlayCompleted=function(){this.renderPosition(0,0),this._enableButtonsBasedOnState()},Nn.prototype._onPlayStopped=function(){this.renderStatus(this.originalDisplayText),this.renderPosition(0,0),this._enableButtonsBasedOnState()},Nn.prototype._onPlaysExhausted=function(){this.renderStatus(this.originalDisplayText),this.renderAlert("There is no more music to play in this station!"),this._enableButtonsBasedOnState()},Nn.prototype._onPlayLiked=function(){this._setLikeStatus(!0)},Nn.prototype._onPlayDisliked=function(){this._setLikeStatus(!1)},Nn.prototype._onPlayUnliked=function(){this._setLikeStatus()},Nn.prototype._onSkipDenied=function(){this.renderAlert("Sorry you've temporarily run out of skips!")},Nn.prototype.formatPlay=function(t){return"<span class='track'>"+t.audio_file.track.title+"</span> by <span class='artist'>"+t.audio_file.artist.name+"</span> on <span class='release'>"+t.audio_file.release.title+"</span>"},Nn.prototype.renderStatus=function(t){var e=this;void 0!==t&&(this.displayText=t),this.alertId||this.$el.querySelectorAll(".status").forEach((function(t){t.innerHTML=e.displayText,t.classList.remove("alert")}))},Nn.prototype.renderPosition=function(t,e){if(this.$el.querySelectorAll(".elapsed").forEach((function(e){e.innerHTML=Bn(t)})),this.$el.querySelectorAll(".duration").forEach((function(t){t.innerHTML=Bn(e)})),0===e)this.$el.querySelectorAll(".progress").forEach((function(t){t.style.width="0"}));else{var i=Math.round((t+1e3)/e*100);i=i>100?100:i,this.$el.querySelectorAll(".progress").forEach((function(t){t.style.width=i+"%"}))}},Nn.prototype.renderAlert=function(t){this.alertId&&window.clearTimeout(this.alertId),this.$el.querySelectorAll(".status").forEach((function(e){e.innerHTML=t,e.classList.add("alert")}));var e=this;this.alertId=window.setTimeout((function(){e.alertId=null,e.renderStatus()}),3e3)},Nn.prototype._onSuspend=function(){this._enableButtonsBasedOnState()},Nn.prototype._enableButtonsBasedOnState=function(){var t,e,i=this.player.getCurrentState();switch(i){case"playing":t=[".pause-button",".like-button",".dislike-button"],e=[".play-button",".start-button",".resume-button"],this.player.maybeCanSkip()?t.push(".skip-button"):e.push(".skip-button");break;case"paused":t=[".play-button",".resume-button",".like-button",".dislike-button"],e=[".pause-button",".start-button"],this.player.maybeCanSkip()?t.push(".skip-button"):e.push(".skip-button");break;case"suspended":t=[],e=[".play-button",".resume-button",".like-button",".dislike-button",".pause-button",".start-button",".skip-button"];break;default:t=[".play-button",".start-button"],e=[".resume-button",".pause-button",".like-button",".dislike-button",".skip-button"]}var n,r=Lt(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;this.$el.querySelectorAll(o).forEach((function(t){t.classList.remove("button-enabled"),t.classList.add("button-disabled"),t.disabled=!0}))}}catch(t){r.e(t)}finally{r.f()}var s,a=Lt(t);try{for(a.s();!(s=a.n()).done;){var u=s.value;this.$el.querySelectorAll(u).forEach((function(t){t.classList.remove("button-disabled"),t.classList.add("button-enabled"),t.disabled=!1}))}}catch(t){a.e(t)}finally{a.f()}var c=this.$el.classList;c.remove("state-playing"),c.remove("state-paused"),c.remove("state-idle"),c.remove("state-suspended"),c.add("state-"+i)},{Speaker:fi,Session:In,Player:qn,Listener:Mn,PlayerView:Nn,log:tt,version:"1.99.20",resetClientId:function(){kn("cid"),An=null}}}();
